<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mushtaq Store - सरकारी सेवाएं</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .service-card:hover { transform: translateY(-5px); }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .admin-panel.hidden { display: none !important; }
        .user-panel.hidden { display: none !important; }
        .login-required { opacity: 0.6; pointer-events: none; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <i class="fas fa-store text-2xl"></i>
                    <h1 class="text-2xl font-bold">Mushtaq Store</h1>
                    <span class="text-sm bg-white/20 px-2 py-1 rounded">सरकारी सेवाएं</span>
                </div>
                <nav class="flex items-center space-x-4">
                    <button id="homeBtn" class="hover:bg-white/20 px-3 py-2 rounded transition">होम</button>
                    <button id="loginBtn" class="bg-white text-purple-600 px-4 py-2 rounded font-semibold hover:bg-gray-100 transition">लॉगिन / साइनअप</button>
                    <button id="logoutBtn" class="hidden bg-red-500 px-4 py-2 rounded font-semibold hover:bg-red-600 transition">लॉगआउट</button>
                </nav>
            </div>
        </div>
    </header>

    <!-- Login/Signup Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-8 w-96 max-w-md mx-4 max-h-[90vh] overflow-y-auto">
            <!-- Login Form -->
            <div id="loginForm">
                <h2 class="text-2xl font-bold mb-6 text-center">लॉगिन करें</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">यूजर टाइप</label>
                        <select id="userType" class="w-full border rounded-lg px-3 py-2">
                            <option value="user">यूजर</option>
                            <option value="admin">एडमिन</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">मोबाइल नंबर</label>
                        <input type="tel" id="mobile" class="w-full border rounded-lg px-3 py-2" placeholder="10 अंकों का मोबाइल नंबर" maxlength="10">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">पासवर्ड</label>
                        <input type="password" id="password" class="w-full border rounded-lg px-3 py-2" placeholder="पासवर्ड दर्ज करें">
                    </div>
                    <div class="flex space-x-3">
                        <button id="loginSubmit" class="flex-1 bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition">लॉगिन</button>
                        <button id="closeLogin" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition">रद्द करें</button>
                    </div>
                    <div class="text-center mt-4">
                        <p class="text-sm text-gray-600">नया यूजर हैं? 
                            <button id="showSignup" class="text-purple-600 hover:text-purple-800 font-semibold">साइनअप करें</button>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Signup Form -->
            <div id="signupForm" class="hidden">
                <h2 class="text-2xl font-bold mb-6 text-center">नया अकाउंट बनाएं</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">पूरा नाम *</label>
                        <input type="text" id="signupName" class="w-full border rounded-lg px-3 py-2" placeholder="अपना पूरा नाम दर्ज करें" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">मोबाइल नंबर *</label>
                        <input type="tel" id="signupMobile" class="w-full border rounded-lg px-3 py-2" placeholder="10 अंकों का मोबाइल नंबर" maxlength="10" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">पासवर्ड बनाएं *</label>
                        <input type="password" id="signupPassword" class="w-full border rounded-lg px-3 py-2" placeholder="कम से कम 4 अंकों का पासवर्ड" minlength="4" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">पासवर्ड कन्फर्म करें *</label>
                        <input type="password" id="confirmPassword" class="w-full border rounded-lg px-3 py-2" placeholder="पासवर्ड दोबारा दर्ज करें" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">ईमेल (वैकल्पिक)</label>
                        <input type="email" id="signupEmail" class="w-full border rounded-lg px-3 py-2" placeholder="आपका ईमेल पता">
                    </div>
                    <div class="bg-blue-50 p-3 rounded-lg">
                        <div class="flex items-start space-x-2">
                            <input type="checkbox" id="termsAgree" required class="mt-1">
                            <label for="termsAgree" class="text-xs text-blue-800">
                                मैं नियम और शर्तों से सहमत हूं और समझता हूं कि मेरी जानकारी सुरक्षित रूप से स्टोर की जाएगी।
                            </label>
                        </div>
                    </div>
                    <div class="flex space-x-3">
                        <button id="signupSubmit" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition">अकाउंट बनाएं</button>
                        <button id="cancelSignup" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition">रद्द करें</button>
                    </div>
                    <div class="text-center mt-4">
                        <p class="text-sm text-gray-600">पहले से अकाउंट है? 
                            <button id="showLogin" class="text-purple-600 hover:text-purple-800 font-semibold">लॉगिन करें</button>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Home Page -->
        <div id="homePage">
            <!-- Hero Section -->
            <div class="gradient-bg text-white rounded-lg p-8 mb-8">
                <div class="text-center">
                    <h2 class="text-3xl font-bold mb-4">सभी सरकारी सेवाएं एक जगह</h2>
                    <p class="text-lg mb-6">आधार कार्ड से लेकर आयुष्मान कार्ड तक - सभी दस्तावेज़ आसानी से बनवाएं</p>
                    <div class="flex justify-center space-x-4 text-sm">
                        <span><i class="fas fa-check mr-2"></i>तुरंत अप्लाई करें</span>
                        <span><i class="fas fa-check mr-2"></i>स्टेटस ट्रैक करें</span>
                        <span><i class="fas fa-check mr-2"></i>होम डिलीवरी</span>
                    </div>
                </div>
            </div>

            <!-- Services Grid -->
            <div class="mb-8">
                <h3 class="text-2xl font-bold mb-6 text-center">हमारी सेवाएं</h3>
                <div id="servicesGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Services will be loaded here -->
                </div>
            </div>

            <!-- Login Required Message -->
            <div id="loginMessage" class="text-center py-8 bg-yellow-50 rounded-lg border border-yellow-200">
                <i class="fas fa-lock text-4xl text-yellow-600 mb-4"></i>
                <h3 class="text-xl font-semibold text-yellow-800 mb-2">सेवा का उपयोग करने के लिए लॉगिन करें</h3>
                <p class="text-yellow-700 mb-4">कृपया अपने अकाउंट में लॉगिन करके सेवाओं का लाभ उठाएं</p>
                <button class="bg-yellow-600 text-white px-6 py-2 rounded-lg hover:bg-yellow-700 transition" onclick="document.getElementById('loginBtn').click()">
                    अभी लॉगिन / साइनअप करें
                </button>
            </div>
        </div>

        <!-- User Panel -->
        <div id="userPanel" class="user-panel">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold">यूजर डैशबोर्ड</h2>
                    <p class="text-gray-600" id="welcomeMessage">स्वागत है!</p>
                </div>
                <button id="trackingBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                    <i class="fas fa-search mr-2"></i>स्टेटस ट्रैक करें
                </button>
            </div>

            <!-- Application History -->
            <div id="applicationHistory" class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h3 class="text-xl font-bold mb-4">
                    <i class="fas fa-history mr-2 text-purple-600"></i>आपके आवेदन
                </h3>
                <div id="userApplicationsList">
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-inbox text-4xl mb-4"></i>
                        <p>अभी तक कोई आवेदन नहीं है</p>
                    </div>
                </div>
            </div>

            <!-- User Services -->
            <div id="userServices" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <!-- User services will be loaded here -->
            </div>

            <!-- Tracking Section -->
            <div id="trackingSection" class="hidden bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4">आवेदन स्टेटस ट्रैक करें</h3>
                <div class="flex space-x-4 mb-4">
                    <input type="text" id="trackingId" placeholder="ट्रैकिंग आईडी दर्ज करें" class="flex-1 border rounded-lg px-3 py-2">
                    <button id="trackBtn" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                        ट्रैक करें
                    </button>
                </div>
                <div id="trackingResult" class="hidden">
                    <!-- Tracking results will appear here -->
                </div>
            </div>
        </div>

        <!-- Service Application Page -->
        <div id="applicationPage" class="hidden">
            <div class="flex items-center mb-6">
                <button id="backToUserPanel" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition mr-4">
                    <i class="fas fa-arrow-left mr-2"></i>वापस जाएं
                </button>
                <h2 class="text-2xl font-bold" id="applicationPageTitle">सेवा के लिए आवेदन</h2>
            </div>

            <!-- Service Details Card -->
            <div id="serviceDetailsCard" class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <!-- Service details will be loaded here -->
            </div>

            <!-- Success Message -->
            <div id="submissionSuccess" class="hidden bg-green-50 border border-green-200 rounded-lg p-6 mb-6">
                <div class="text-center">
                    <div class="text-6xl text-green-600 mb-4">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3 class="text-2xl font-bold text-green-800 mb-4">🎉 फॉर्म सफलतापूर्वक जमा हो गया!</h3>
                    <div id="successDetails" class="space-y-2 text-green-700 mb-4">
                        <!-- Success details will be filled here -->
                    </div>
                    <div class="bg-white rounded-lg p-4 border border-green-300">
                        <p class="text-sm text-green-600 mb-2">
                            <i class="fas fa-info-circle mr-2"></i>आपका आवेदन सफलतापूर्वक जमा हो गया है
                        </p>
                        <p class="text-xs text-green-500">
                            <i class="fas fa-clock mr-2"></i>3 सेकंड में यूजर पैनल पर वापस जा रहे हैं...
                        </p>
                    </div>
                </div>
            </div>

            <!-- Application Form -->
            <div id="applicationFormContainer" class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-6">आवेदन फॉर्म भरें</h3>
                <form id="serviceForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">पूरा नाम *</label>
                            <input type="text" name="fullName" required class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">मोबाइल नंबर *</label>
                            <input type="tel" name="mobile" required class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">पिता का नाम</label>
                            <input type="text" name="fatherName" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">जन्म तिथि</label>
                            <input type="date" name="dob" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">आधार नंबर</label>
                            <input type="text" name="aadhar" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="12 अंकों का आधार नंबर">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">ईमेल</label>
                            <input type="email" name="email" class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">पूरा पता *</label>
                        <textarea name="address" required class="w-full border rounded-lg px-3 py-2 h-24 focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="गांव/शहर, तहसील, जिला, राज्य, पिन कोड"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">अतिरिक्त जानकारी</label>
                        <textarea name="additionalInfo" class="w-full border rounded-lg px-3 py-2 h-20 focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="कोई विशेष आवश्यकता या टिप्पणी"></textarea>
                    </div>
                    
                    <!-- Terms and Conditions -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <div class="flex items-start space-x-3">
                            <input type="checkbox" id="termsAccept" required class="mt-1">
                            <label for="termsAccept" class="text-sm text-gray-700">
                                मैं घोषणा करता/करती हूं कि ऊपर दी गई सभी जानकारी सत्य है। मैं नियम और शर्तों से सहमत हूं और समझता हूं कि गलत जानकारी देने पर मेरा आवेदन रद्द हो सकता है।
                            </label>
                        </div>
                    </div>

                    <div class="flex space-x-4 pt-4">
                        <button type="submit" class="bg-green-600 text-white px-8 py-3 rounded-lg hover:bg-green-700 transition font-semibold">
                            <i class="fas fa-paper-plane mr-2"></i>आवेदन जमा करें
                        </button>
                        <button type="button" id="cancelForm" class="bg-gray-500 text-white px-8 py-3 rounded-lg hover:bg-gray-600 transition font-semibold">
                            <i class="fas fa-times mr-2"></i>रद्द करें
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="admin-panel">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">एडमिन पैनल</h2>
                <div class="flex space-x-4">
                    <button id="addServiceBtn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                        <i class="fas fa-plus mr-2"></i>सेवा जोड़ें
                    </button>
                    <button id="settingsBtn" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                        <i class="fas fa-cog mr-2"></i>सेटिंग्स
                    </button>
                </div>
            </div>

            <!-- Admin Tabs -->
            <div class="bg-white rounded-lg shadow-lg">
                <div class="border-b">
                    <nav class="flex space-x-8 px-6">
                        <button class="admin-tab py-4 border-b-2 border-purple-600 text-purple-600 font-semibold" data-tab="services">सेवाएं</button>
                        <button class="admin-tab py-4 text-gray-500 hover:text-gray-700" data-tab="applications">आवेदन</button>
                        <button class="admin-tab py-4 text-gray-500 hover:text-gray-700" data-tab="users">यूजर्स</button>
                        <button class="admin-tab py-4 text-gray-500 hover:text-gray-700" data-tab="settings">सेटिंग्स</button>
                    </nav>
                </div>

                <!-- Services Management -->
                <div id="adminServices" class="admin-content p-6">
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-4 py-2 text-left">सेवा नाम</th>
                                    <th class="px-4 py-2 text-left">फीस</th>
                                    <th class="px-4 py-2 text-left">समय</th>
                                    <th class="px-4 py-2 text-left">स्टेटस</th>
                                    <th class="px-4 py-2 text-left">एक्शन</th>
                                </tr>
                            </thead>
                            <tbody id="adminServicesTable">
                                <!-- Services will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Applications Management -->
                <div id="adminApplications" class="admin-content p-6 hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-4 py-2 text-left">आवेदन ID</th>
                                    <th class="px-4 py-2 text-left">नाम</th>
                                    <th class="px-4 py-2 text-left">सेवा</th>
                                    <th class="px-4 py-2 text-left">दिनांक</th>
                                    <th class="px-4 py-2 text-left">स्टेटस</th>
                                    <th class="px-4 py-2 text-left">एक्शन</th>
                                </tr>
                            </thead>
                            <tbody id="adminApplicationsTable">
                                <!-- Applications will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Users Management -->
                <div id="adminUsers" class="admin-content p-6 hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full table-auto">
                            <thead>
                                <tr class="bg-gray-50">
                                    <th class="px-4 py-2 text-left">यूजर ID</th>
                                    <th class="px-4 py-2 text-left">नाम</th>
                                    <th class="px-4 py-2 text-left">मोबाइल</th>
                                    <th class="px-4 py-2 text-left">आवेदन</th>
                                    <th class="px-4 py-2 text-left">एक्शन</th>
                                </tr>
                            </thead>
                            <tbody id="adminUsersTable">
                                <!-- Users will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Settings -->
                <div id="adminSettings" class="admin-content p-6 hidden">
                    <div class="grid grid-cols-1 gap-8">
                        <!-- Database Connection Options -->
                        <div class="bg-white border rounded-lg p-6">
                            <h4 class="text-xl font-semibold mb-6 text-center">डेटाबेस कनेक्शन विकल्प</h4>
                            
                            <!-- Database Selection -->
                            <div class="mb-6">
                                <label class="block text-sm font-medium mb-3">डेटाबेस चुनें:</label>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="border border-gray-200 rounded-lg p-4 cursor-pointer hover:bg-blue-50 transition" data-db="sheets">
                                        <div class="text-center">
                                            <i class="fas fa-table text-3xl text-green-600 mb-2"></i>
                                            <h5 class="font-semibold">Google Sheets</h5>
                                            <p class="text-sm text-gray-600">स्प्रेडशीट डेटाबेस</p>
                                        </div>
                                    </div>
                                    <div class="border border-gray-200 rounded-lg p-4 cursor-pointer hover:bg-blue-50 transition" data-db="jsonbin">
                                        <div class="text-center">
                                            <i class="fas fa-database text-3xl text-blue-600 mb-2"></i>
                                            <h5 class="font-semibold">JSONBin</h5>
                                            <p class="text-sm text-gray-600">JSON डेटाबेस</p>
                                        </div>
                                    </div>
                                    <div class="border border-gray-200 rounded-lg p-4 cursor-pointer hover:bg-blue-50 transition" data-db="firebase">
                                        <div class="text-center">
                                            <i class="fas fa-fire text-3xl text-orange-600 mb-2"></i>
                                            <h5 class="font-semibold">Firebase</h5>
                                            <p class="text-sm text-gray-600">रियल-टाइम डेटाबेस</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Google Sheets Configuration -->
                            <div id="sheetsConfig" class="database-config hidden bg-green-50 border border-green-200 rounded-lg p-6">
                                <h5 class="text-lg font-semibold mb-4 text-green-800">
                                    <i class="fas fa-table mr-2"></i>Google Sheets कॉन्फ़िगरेशन
                                </h5>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Spreadsheet URL *</label>
                                        <input type="url" id="sheetsUrl" class="w-full border rounded-lg px-3 py-2" placeholder="https://docs.google.com/spreadsheets/d/...">
                                        <p class="text-xs text-gray-600 mt-1">पूरा Google Sheets URL दर्ज करें</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">API Key *</label>
                                        <input type="text" id="sheetsApiKey" class="w-full border rounded-lg px-3 py-2" placeholder="Google Sheets API Key">
                                        <p class="text-xs text-gray-600 mt-1">Google Cloud Console से API Key प्राप्त करें</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Sheet Name</label>
                                        <input type="text" id="sheetName" class="w-full border rounded-lg px-3 py-2" placeholder="Sheet1" value="Sheet1">
                                        <p class="text-xs text-gray-600 mt-1">डेटा स्टोर करने के लिए शीट का नाम</p>
                                    </div>
                                    <div class="flex space-x-3">
                                        <button id="testSheetsBtn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                            <i class="fas fa-plug mr-2"></i>कनेक्शन टेस्ट करें
                                        </button>
                                        <button id="saveSheetsBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                            <i class="fas fa-save mr-2"></i>सेव करें
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- JSONBin Configuration -->
                            <div id="jsonbinConfig" class="database-config hidden bg-blue-50 border border-blue-200 rounded-lg p-6">
                                <h5 class="text-lg font-semibold mb-4 text-blue-800">
                                    <i class="fas fa-database mr-2"></i>JSONBin कॉन्फ़िगरेशन
                                </h5>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">API Key *</label>
                                        <input type="text" id="jsonbinApiKey" class="w-full border rounded-lg px-3 py-2" placeholder="$2a$10$...">
                                        <p class="text-xs text-gray-600 mt-1">JSONBin.io से API Key प्राप्त करें</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Bin ID</label>
                                        <input type="text" id="jsonbinId" class="w-full border rounded-lg px-3 py-2" placeholder="64a7b2c8b89b1e2...">
                                        <p class="text-xs text-gray-600 mt-1">मौजूदा Bin ID (वैकल्पिक - नया Bin बनेगा)</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Bin Name</label>
                                        <input type="text" id="jsonbinName" class="w-full border rounded-lg px-3 py-2" placeholder="mushtaq-store-data" value="mushtaq-store-data">
                                        <p class="text-xs text-gray-600 mt-1">डेटा स्टोरेज के लिए Bin का नाम</p>
                                    </div>
                                    <div class="flex space-x-3">
                                        <button id="testJsonbinBtn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                                            <i class="fas fa-plug mr-2"></i>कनेक्शन टेस्ट करें
                                        </button>
                                        <button id="saveJsonbinBtn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                            <i class="fas fa-save mr-2"></i>सेव करें
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Firebase Configuration -->
                            <div id="firebaseConfig" class="database-config hidden bg-orange-50 border border-orange-200 rounded-lg p-6">
                                <h5 class="text-lg font-semibold mb-4 text-orange-800">
                                    <i class="fas fa-fire mr-2"></i>Firebase कॉन्फ़िगरेशन
                                </h5>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Project ID *</label>
                                        <input type="text" id="firebaseProjectId" class="w-full border rounded-lg px-3 py-2" placeholder="my-project-id">
                                        <p class="text-xs text-gray-600 mt-1">Firebase प्रोजेक्ट ID</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">API Key *</label>
                                        <input type="text" id="firebaseApiKey" class="w-full border rounded-lg px-3 py-2" placeholder="AIzaSy...">
                                        <p class="text-xs text-gray-600 mt-1">Firebase Web API Key</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Database URL *</label>
                                        <input type="url" id="firebaseDatabaseUrl" class="w-full border rounded-lg px-3 py-2" placeholder="https://project-id-default-rtdb.firebaseio.com/">
                                        <p class="text-xs text-gray-600 mt-1">Realtime Database URL</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Auth Domain</label>
                                        <input type="text" id="firebaseAuthDomain" class="w-full border rounded-lg px-3 py-2" placeholder="project-id.firebaseapp.com">
                                        <p class="text-xs text-gray-600 mt-1">Firebase Auth Domain</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2">Storage Bucket</label>
                                        <input type="text" id="firebaseStorageBucket" class="w-full border rounded-lg px-3 py-2" placeholder="project-id.appspot.com">
                                        <p class="text-xs text-gray-600 mt-1">Firebase Storage Bucket</p>
                                    </div>
                                    <div class="flex space-x-3">
                                        <button id="testFirebaseBtn" class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition">
                                            <i class="fas fa-plug mr-2"></i>कनेक्शन टेस्ट करें
                                        </button>
                                        <button id="saveFirebaseBtn" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                            <i class="fas fa-save mr-2"></i>सेव करें
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Connection Status -->
                            <div id="connectionStatus" class="mt-6 p-4 rounded-lg hidden">
                                <h6 class="font-semibold mb-2">कनेक्शन स्टेटस:</h6>
                                <div id="statusContent"></div>
                            </div>

                            <!-- Active Database Status -->
                            <div id="activeDatabaseStatus" class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                                <h6 class="font-semibold mb-2 text-gray-800">
                                    <i class="fas fa-database mr-2"></i>वर्तमान डेटाबेस स्थिति:
                                </h6>
                                <div id="databaseStatusContent" class="text-sm text-gray-600">
                                    <i class="fas fa-info-circle mr-2"></i>कोई डेटाबेस कॉन्फ़िगर नहीं है - डेटा केवल लोकल स्टोरेज में सेव होगा
                                </div>
                            </div>
                        </div>

                        <!-- Home Page Settings -->
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h4 class="text-lg font-semibold mb-4">होम पेज सेटिंग्स</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">स्टोर नाम</label>
                                    <input type="text" id="storeName" value="Mushtaq Store" class="w-full border rounded-lg px-3 py-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">हेडलाइन</label>
                                    <input type="text" id="headline" value="सभी सरकारी सेवाएं एक जगह" class="w-full border rounded-lg px-3 py-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">संपर्क नंबर</label>
                                    <input type="tel" id="contactNumber" class="w-full border rounded-lg px-3 py-2" placeholder="संपर्क नंबर">
                                </div>
                                <button id="previewChanges" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                                    प्रीव्यू देखें
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Service Modal -->
        <div id="addServiceModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-lg p-8 w-96 max-w-md mx-4">
                <h3 class="text-xl font-bold mb-4">नई सेवा जोड़ें</h3>
                <form id="addServiceForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">सेवा नाम</label>
                        <input type="text" name="serviceName" required class="w-full border rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">फीस (₹)</label>
                        <input type="number" name="fee" required class="w-full border rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">समय (दिन)</label>
                        <input type="number" name="duration" required class="w-full border rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">विवरण</label>
                        <textarea name="description" class="w-full border rounded-lg px-3 py-2 h-20"></textarea>
                    </div>
                    <div class="flex space-x-3">
                        <button type="submit" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition">जोड़ें</button>
                        <button type="button" id="closeAddService" class="flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition">रद्द करें</button>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <script>
        // App State
        let currentUser = null;
        let registeredUsers = JSON.parse(localStorage.getItem('registeredUsers')) || [];
        let services = [
            { id: 1, name: 'आधार कार्ड', icon: 'fas fa-id-card', fee: 50, duration: '7-10 दिन', description: 'नया आधार कार्ड बनवाएं या अपडेट करें', active: true },
            { id: 2, name: 'पैन कार्ड', icon: 'fas fa-credit-card', fee: 100, duration: '15-20 दिन', description: 'पैन कार्ड के लिए आवेदन करें', active: true },
            { id: 3, name: 'वोटर कार्ड', icon: 'fas fa-vote-yea', fee: 25, duration: '30-45 दिन', description: 'वोटर आईडी कार्ड बनवाएं', active: true },
            { id: 4, name: 'आयुष्मान कार्ड', icon: 'fas fa-heartbeat', fee: 30, duration: '5-7 दिन', description: 'आयुष्मान भारत गोल्डन कार्ड', active: true },
            { id: 5, name: 'ABHA कार्ड', icon: 'fas fa-hospital', fee: 20, duration: '3-5 दिन', description: 'आयुष्मान भारत हेल्थ अकाउंट', active: true },
            { id: 6, name: 'जन्म प्रमाण पत्र', icon: 'fas fa-baby', fee: 40, duration: '10-15 दिन', description: 'जन्म का प्रमाण पत्र', active: true },
            { id: 7, name: 'मृत्यु प्रमाण पत्र', icon: 'fas fa-cross', fee: 40, duration: '10-15 दिन', description: 'मृत्यु का प्रमाण पत्र', active: true },
            { id: 8, name: 'आय प्रमाण पत्र', icon: 'fas fa-money-bill', fee: 60, duration: '15-20 दिन', description: 'आय का प्रमाण पत्र', active: true },
            { id: 9, name: 'राशन कार्ड', icon: 'fas fa-shopping-basket', fee: 80, duration: '20-30 दिन', description: 'राशन कार्ड के लिए आवेदन', active: true }
        ];
        
        let applications = [];
        let users = [];

        // DOM Elements
        const loginBtn = document.getElementById('loginBtn');
        const logoutBtn = document.getElementById('logoutBtn');
        const loginModal = document.getElementById('loginModal');
        const homePage = document.getElementById('homePage');
        const userPanel = document.getElementById('userPanel');
        const adminPanel = document.getElementById('adminPanel');

        // Initialize App
        function initApp() {
            loadServices();
            setupEventListeners();
            updateUI();
            loadSavedConfig();
        }

        // Event Listeners
        function setupEventListeners() {
            // Login/Logout
            loginBtn.addEventListener('click', () => {
                loginModal.classList.remove('hidden');
                showLoginForm();
            });
            logoutBtn.addEventListener('click', logout);
            document.getElementById('closeLogin').addEventListener('click', () => loginModal.classList.add('hidden'));
            document.getElementById('loginSubmit').addEventListener('click', handleLogin);
            
            // Signup
            document.getElementById('showSignup').addEventListener('click', showSignupForm);
            document.getElementById('showLogin').addEventListener('click', showLoginForm);
            document.getElementById('signupSubmit').addEventListener('click', handleSignup);
            document.getElementById('cancelSignup').addEventListener('click', () => loginModal.classList.add('hidden'));

            // Navigation
            document.getElementById('homeBtn').addEventListener('click', showHome);
            document.getElementById('backToUserPanel').addEventListener('click', showUserPanel);

            // User Panel
            document.getElementById('trackingBtn').addEventListener('click', showTracking);
            document.getElementById('cancelForm').addEventListener('click', showUserPanel);
            document.getElementById('serviceForm').addEventListener('submit', handleServiceApplication);
            document.getElementById('trackBtn').addEventListener('click', trackApplication);

            // Admin Panel
            document.getElementById('addServiceBtn').addEventListener('click', () => document.getElementById('addServiceModal').classList.remove('hidden'));
            document.getElementById('closeAddService').addEventListener('click', () => document.getElementById('addServiceModal').classList.add('hidden'));
            document.getElementById('addServiceForm').addEventListener('submit', handleAddService);
            document.getElementById('previewChanges').addEventListener('click', previewHomePageChanges);

            // Admin Tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', (e) => switchAdminTab(e.target.dataset.tab));
            });

            // Database Selection Cards
            document.querySelectorAll('[data-db]').forEach(card => {
                card.addEventListener('click', (e) => {
                    const dbType = e.currentTarget.dataset.db;
                    selectDatabase(dbType, e);
                });
            });

            // Database Configuration Buttons
            document.getElementById('testSheetsBtn').addEventListener('click', testSheetsConnection);
            document.getElementById('saveSheetsBtn').addEventListener('click', saveSheetsConfig);
            document.getElementById('testJsonbinBtn').addEventListener('click', testJsonbinConnection);
            document.getElementById('saveJsonbinBtn').addEventListener('click', saveJsonbinConfig);
            document.getElementById('testFirebaseBtn').addEventListener('click', testFirebaseConnection);
            document.getElementById('saveFirebaseBtn').addEventListener('click', saveFirebaseConfig);
        }

        // User Management Functions
        function handleLogin() {
            const userType = document.getElementById('userType').value;
            const mobile = document.getElementById('mobile').value;
            const password = document.getElementById('password').value;

            if (!mobile || !password) {
                alert('कृपया सभी फील्ड भरें');
                return;
            }

            // Admin credentials (hardcoded)
            if (userType === 'admin' && mobile === '2206' && password === '9958') {
                currentUser = { type: userType, mobile: mobile, name: 'Admin' };
                loginModal.classList.add('hidden');
                updateUI();
                clearLoginForm();
                alert('एडमिन लॉगिन सफल!');
                return;
            }

            // User credentials (check registered users)
            if (userType === 'user') {
                const user = registeredUsers.find(u => u.mobile === mobile && u.password === password);
                if (user) {
                    currentUser = { type: userType, mobile: mobile, name: user.name, email: user.email };
                    
                    // Update last login
                    user.lastLogin = new Date().toISOString();
                    localStorage.setItem('registeredUsers', JSON.stringify(registeredUsers));
                    
                    loginModal.classList.add('hidden');
                    updateUI();
                    clearLoginForm();
                    alert(`स्वागत है ${user.name}! लॉगिन सफल।`);
                    
                    // Load user's applications from database
                    loadUserApplicationsFromDatabase();
                } else {
                    alert('गलत मोबाइल नंबर या पासवर्ड।\n\nयदि आपका अकाउंट नहीं है तो कृपया "साइनअप करें" पर क्लिक करें।');
                }
                return;
            }

            alert('गलत लॉगिन जानकारी');
        }

        function handleSignup() {
            const name = document.getElementById('signupName').value.trim();
            const mobile = document.getElementById('signupMobile').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const email = document.getElementById('signupEmail').value.trim();
            const termsAgree = document.getElementById('termsAgree').checked;

            // Validation
            if (!name || !mobile || !password || !confirmPassword) {
                alert('कृपया सभी आवश्यक फील्ड भरें (*)');
                return;
            }

            if (mobile.length !== 10 || !/^\d{10}$/.test(mobile)) {
                alert('कृपया 10 अंकों का सही मोबाइल नंबर दर्ज करें');
                return;
            }

            if (password.length < 4) {
                alert('पासवर्ड कम से कम 4 अंकों का होना चाहिए');
                return;
            }

            if (password !== confirmPassword) {
                alert('पासवर्ड मैच नहीं कर रहे। कृपया दोबारा चेक करें।');
                return;
            }

            if (!termsAgree) {
                alert('कृपया नियम और शर्तों से सहमति दें');
                return;
            }

            // Check if user already exists
            const existingUser = registeredUsers.find(u => u.mobile === mobile);
            if (existingUser) {
                alert('इस मोबाइल नंबर से पहले से अकाउंट है। कृपया लॉगिन करें।');
                showLoginForm();
                document.getElementById('mobile').value = mobile;
                return;
            }

            // Create new user
            const newUser = {
                id: 'USER' + Date.now(),
                name: name,
                mobile: mobile,
                password: password,
                email: email || null,
                createdAt: new Date().toISOString(),
                lastLogin: new Date().toISOString()
            };

            // Save user
            registeredUsers.push(newUser);
            localStorage.setItem('registeredUsers', JSON.stringify(registeredUsers));

            // Save to database
            saveUserToDatabase(newUser);

            // Auto login
            currentUser = { type: 'user', mobile: mobile, name: name, email: email };
            loginModal.classList.add('hidden');
            updateUI();
            clearSignupForm();

            alert(`🎉 अकाउंट सफलतापूर्वक बना गया!\n\nस्वागत है ${name}!\n\nआपका मोबाइल नंबर: ${mobile}\nअब आप सभी सेवाओं का उपयोग कर सकते हैं।`);
        }

        function showSignupForm() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
        }

        function showLoginForm() {
            document.getElementById('signupForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
        }

        function clearLoginForm() {
            document.getElementById('mobile').value = '';
            document.getElementById('password').value = '';
        }

        function clearSignupForm() {
            document.getElementById('signupName').value = '';
            document.getElementById('signupMobile').value = '';
            document.getElementById('signupPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            document.getElementById('signupEmail').value = '';
            document.getElementById('termsAgree').checked = false;
        }

        function logout() {
            currentUser = null;
            updateUI();
            alert('लॉगआउट सफल!');
        }

        // UI Updates
        function updateUI() {
            if (currentUser) {
                loginBtn.classList.add('hidden');
                logoutBtn.classList.remove('hidden');
                
                if (currentUser.type === 'admin') {
                    homePage.classList.add('hidden');
                    userPanel.classList.add('hidden');
                    adminPanel.classList.remove('hidden');
                    adminPanel.style.display = 'block';
                    loadAdminData();
                } else {
                    homePage.classList.add('hidden');
                    adminPanel.classList.add('hidden');
                    userPanel.classList.remove('hidden');
                    userPanel.style.display = 'block';
                    
                    // Update welcome message
                    document.getElementById('welcomeMessage').textContent = `स्वागत है ${currentUser.name}!`;
                    
                    loadUserServices();
                    loadUserApplicationHistory();
                }
            } else {
                loginBtn.classList.remove('hidden');
                logoutBtn.classList.add('hidden');
                adminPanel.classList.add('hidden');
                adminPanel.style.display = 'none';
                userPanel.classList.add('hidden');
                userPanel.style.display = 'none';
                homePage.classList.remove('hidden');
            }
        }

        function showHome() {
            adminPanel.classList.add('hidden');
            userPanel.classList.add('hidden');
            document.getElementById('applicationPage').classList.add('hidden');
            homePage.classList.remove('hidden');
        }

        function showUserPanel() {
            adminPanel.classList.add('hidden');
            homePage.classList.add('hidden');
            document.getElementById('applicationPage').classList.add('hidden');
            userPanel.classList.remove('hidden');
            userPanel.style.display = 'block';
            loadUserApplicationHistory();
        }

        function showApplicationPage() {
            adminPanel.classList.add('hidden');
            homePage.classList.add('hidden');
            userPanel.classList.add('hidden');
            document.getElementById('applicationPage').classList.remove('hidden');
        }

        // Services Management
        function loadServices() {
            const servicesGrid = document.getElementById('servicesGrid');
            servicesGrid.innerHTML = '';

            services.filter(service => service.active).forEach(service => {
                const serviceCard = createServiceCard(service, !currentUser);
                servicesGrid.appendChild(serviceCard);
            });
        }

        function loadUserServices() {
            const userServices = document.getElementById('userServices');
            userServices.innerHTML = '';

            services.filter(service => service.active).forEach(service => {
                const serviceCard = createServiceCard(service, false);
                userServices.appendChild(serviceCard);
            });
        }

        function createServiceCard(service, disabled = false) {
            const card = document.createElement('div');
            card.className = `service-card bg-white rounded-lg shadow-lg p-6 transition-all duration-300 ${disabled ? 'login-required' : 'hover:shadow-xl cursor-pointer'}`;
            
            card.innerHTML = `
                <div class="text-center">
                    <div class="text-4xl text-purple-600 mb-4">
                        <i class="${service.icon}"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">${service.name}</h3>
                    <p class="text-gray-600 text-sm mb-4">${service.description}</p>
                    <div class="flex justify-between items-center text-sm text-gray-500 mb-4">
                        <span><i class="fas fa-rupee-sign"></i> ₹${service.fee}</span>
                        <span><i class="fas fa-clock"></i> ${service.duration}</span>
                    </div>
                    <button class="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700 transition ${disabled ? 'opacity-50 cursor-not-allowed' : ''}" 
                            ${disabled ? 'disabled' : `onclick="applyForService(${service.id})"`}>
                        ${disabled ? 'लॉगिन करें' : 'अभी अप्लाई करें'}
                    </button>
                </div>
            `;

            return card;
        }

        // Service Application
        function applyForService(serviceId) {
            const service = services.find(s => s.id === serviceId);
            if (!service) return;

            // Update page title
            document.getElementById('applicationPageTitle').textContent = `${service.name} के लिए आवेदन`;
            
            // Show service details
            const serviceDetailsCard = document.getElementById('serviceDetailsCard');
            serviceDetailsCard.innerHTML = `
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="text-4xl text-purple-600">
                            <i class="${service.icon}"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold">${service.name}</h3>
                            <p class="text-gray-600">${service.description}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold text-green-600">₹${service.fee}</div>
                        <div class="text-sm text-gray-500">
                            <i class="fas fa-clock mr-1"></i>${service.duration}
                        </div>
                    </div>
                </div>
                <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2">आवश्यक दस्तावेज:</h4>
                    <ul class="text-sm text-blue-700 space-y-1">
                        <li><i class="fas fa-check mr-2"></i>आधार कार्ड की फोटोकॉपी</li>
                        <li><i class="fas fa-check mr-2"></i>पासपोर्ट साइज फोटो</li>
                        <li><i class="fas fa-check mr-2"></i>पता प्रमाण पत्र</li>
                        <li><i class="fas fa-check mr-2"></i>मोबाइल नंबर</li>
                    </ul>
                </div>
            `;
            
            // Store service ID for form submission
            document.getElementById('serviceForm').dataset.serviceId = serviceId;
            
            // Pre-fill user data if available
            if (currentUser) {
                document.querySelector('input[name="fullName"]').value = currentUser.name || '';
                document.querySelector('input[name="mobile"]').value = currentUser.mobile || '';
                document.querySelector('input[name="email"]').value = currentUser.email || '';
            }
            
            // Hide success message and show form
            document.getElementById('submissionSuccess').classList.add('hidden');
            document.getElementById('applicationFormContainer').classList.remove('hidden');
            
            // Show application page
            showApplicationPage();
        }

        async function handleServiceApplication(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const serviceId = parseInt(e.target.dataset.serviceId);
            const service = services.find(s => s.id === serviceId);
            
            const application = {
                id: 'APP' + Date.now(),
                serviceId: serviceId,
                serviceName: service.name,
                fullName: formData.get('fullName'),
                mobile: formData.get('mobile'),
                fatherName: formData.get('fatherName'),
                dob: formData.get('dob'),
                aadhar: formData.get('aadhar'),
                email: formData.get('email'),
                address: formData.get('address'),
                additionalInfo: formData.get('additionalInfo'),
                status: 'आवेदन प्राप्त',
                date: new Date().toLocaleDateString('hi-IN'),
                userMobile: currentUser.mobile,
                userName: currentUser.name,
                timestamp: new Date().toISOString()
            };
            
            // Add to local storage
            applications.push(application);
            
            // Save to configured database
            try {
                await saveApplicationToDatabase(application);
                console.log('✅ Application saved to database successfully');
            } catch (error) {
                console.error('❌ Error saving to database:', error);
                console.log('📝 Application saved locally only');
            }
            
            // Show success message on the page
            showSubmissionSuccess(application, service);
            
            // Reset form and go back to user panel after 3 seconds
            e.target.reset();
            setTimeout(() => {
                showUserPanel();
            }, 3000);
        }

        function showSubmissionSuccess(application, service) {
            // Hide form and show success message
            document.getElementById('applicationFormContainer').classList.add('hidden');
            document.getElementById('submissionSuccess').classList.remove('hidden');
            
            // Fill success details
            document.getElementById('successDetails').innerHTML = `
                <div class="bg-white rounded-lg p-4 border border-green-300">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                            <p class="font-semibold text-green-800">📋 ट्रैकिंग ID:</p>
                            <p class="text-green-700 font-mono bg-green-100 px-2 py-1 rounded">${application.id}</p>
                        </div>
                        <div>
                            <p class="font-semibold text-green-800">📄 सेवा:</p>
                            <p class="text-green-700">${service.name}</p>
                        </div>
                        <div>
                            <p class="font-semibold text-green-800">💰 फीस:</p>
                            <p class="text-green-700">₹${service.fee}</p>
                        </div>
                        <div>
                            <p class="font-semibold text-green-800">⏰ समय:</p>
                            <p class="text-green-700">${service.duration}</p>
                        </div>
                        <div>
                            <p class="font-semibold text-green-800">👤 नाम:</p>
                            <p class="text-green-700">${application.fullName}</p>
                        </div>
                        <div>
                            <p class="font-semibold text-green-800">📱 मोबाइल:</p>
                            <p class="text-green-700">${application.mobile}</p>
                        </div>
                    </div>
                </div>
                <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <p class="text-sm text-blue-800">
                        <i class="fas fa-info-circle mr-2"></i>
                        <strong>महत्वपूर्ण:</strong> कृपया अपनी ट्रैकिंग ID सुरक्षित रखें। आप इसका उपयोग करके अपने आवेदन का स्टेटस ट्रैक कर सकते हैं।
                    </p>
                </div>
            `;
            
            // Scroll to success message
            document.getElementById('submissionSuccess').scrollIntoView({ behavior: 'smooth' });
        }

        // User Application History
        function loadUserApplicationHistory() {
            if (!currentUser) return;
            
            const userApplicationsList = document.getElementById('userApplicationsList');
            const userApps = applications.filter(app => app.userMobile === currentUser.mobile);
            
            if (userApps.length === 0) {
                userApplicationsList.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <i class="fas fa-inbox text-4xl mb-4"></i>
                        <p>अभी तक कोई आवेदन नहीं है</p>
                        <p class="text-sm mt-2">नीचे दी गई सेवाओं में से किसी के लिए आवेदन करें</p>
                    </div>
                `;
                return;
            }
            
            userApplicationsList.innerHTML = `
                <div class="space-y-4">
                    ${userApps.map(app => `
                        <div class="border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition">
                            <div class="flex justify-between items-start">
                                <div class="flex-1">
                                    <div class="flex items-center space-x-3 mb-2">
                                        <h4 class="font-semibold text-lg">${app.serviceName}</h4>
                                        <span class="px-2 py-1 rounded text-xs font-medium ${getStatusColor(app.status)}">
                                            ${app.status}
                                        </span>
                                    </div>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600">
                                        <div>
                                            <i class="fas fa-id-badge mr-2"></i>
                                            <strong>ID:</strong> ${app.id}
                                        </div>
                                        <div>
                                            <i class="fas fa-calendar mr-2"></i>
                                            <strong>दिनांक:</strong> ${app.date}
                                        </div>
                                        <div>
                                            <i class="fas fa-user mr-2"></i>
                                            <strong>नाम:</strong> ${app.fullName}
                                        </div>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <button onclick="viewApplicationDetails('${app.id}')" class="text-blue-600 hover:text-blue-800 text-sm">
                                        <i class="fas fa-eye mr-1"></i>विवरण देखें
                                    </button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        async function loadUserApplicationsFromDatabase() {
            // This function will load user applications from the database
            // For now, it uses local storage, but can be extended to fetch from configured database
            console.log('Loading user applications from database...');
        }

        function getStatusColor(status) {
            switch(status) {
                case 'आवेदन प्राप्त': return 'bg-blue-100 text-blue-800';
                case 'प्रक्रिया में': return 'bg-yellow-100 text-yellow-800';
                case 'तैयार': return 'bg-green-100 text-green-800';
                case 'डिलीवर किया गया': return 'bg-purple-100 text-purple-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function viewApplicationDetails(appId) {
            const application = applications.find(app => app.id === appId);
            if (application) {
                const service = services.find(s => s.id === application.serviceId);
                alert(`📋 आवेदन विवरण:\n\n🆔 ID: ${application.id}\n📄 सेवा: ${application.serviceName}\n👤 नाम: ${application.fullName}\n📱 मोबाइल: ${application.mobile}\n👨‍👦 पिता का नाम: ${application.fatherName || 'N/A'}\n🎂 जन्म तिथि: ${application.dob || 'N/A'}\n🏠 पता: ${application.address}\n📧 ईमेल: ${application.email || 'N/A'}\n📅 दिनांक: ${application.date}\n📊 स्टेटस: ${application.status}\n💰 फीस: ₹${service?.fee || 'N/A'}`);
            }
        }

        // Tracking
        function showTracking() {
            document.getElementById('trackingSection').classList.remove('hidden');
            document.getElementById('trackingSection').scrollIntoView({ behavior: 'smooth' });
        }

        function trackApplication() {
            const trackingId = document.getElementById('trackingId').value.trim();
            const trackingResult = document.getElementById('trackingResult');
            
            if (!trackingId) {
                alert('कृपया ट्रैकिंग ID दर्ज करें');
                return;
            }
            
            const application = applications.find(app => app.id === trackingId);
            
            if (application) {
                trackingResult.innerHTML = `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h4 class="font-semibold text-green-800 mb-2">आवेदन मिल गया!</h4>
                        <div class="space-y-2 text-sm">
                            <p><strong>सेवा:</strong> ${application.serviceName}</p>
                            <p><strong>नाम:</strong> ${application.fullName}</p>
                            <p><strong>दिनांक:</strong> ${application.date}</p>
                            <p><strong>स्टेटस:</strong> <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">${application.status}</span></p>
                        </div>
                    </div>
                `;
                trackingResult.classList.remove('hidden');
            } else {
                trackingResult.innerHTML = `
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <p class="text-red-800">इस ट्रैकिंग ID से कोई आवेदन नहीं मिला</p>
                    </div>
                `;
                trackingResult.classList.remove('hidden');
            }
        }

        // Admin Functions
        function loadAdminData() {
            loadAdminServices();
            loadAdminApplications();
            loadAdminUsers();
        }

        function loadAdminServices() {
            const table = document.getElementById('adminServicesTable');
            table.innerHTML = '';
            
            services.forEach(service => {
                const row = document.createElement('tr');
                row.className = 'border-b hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-4 py-3">${service.name}</td>
                    <td class="px-4 py-3">₹${service.fee}</td>
                    <td class="px-4 py-3">${service.duration}</td>
                    <td class="px-4 py-3">
                        <span class="px-2 py-1 rounded text-xs ${service.active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                            ${service.active ? 'सक्रिय' : 'निष्क्रिय'}
                        </span>
                    </td>
                    <td class="px-4 py-3">
                        <button onclick="toggleService(${service.id})" class="text-blue-600 hover:text-blue-800 mr-2">
                            ${service.active ? 'बंद करें' : 'चालू करें'}
                        </button>
                        <button onclick="editService(${service.id})" class="text-green-600 hover:text-green-800 mr-2">एडिट</button>
                        <button onclick="deleteService(${service.id})" class="text-red-600 hover:text-red-800">डिलीट</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        function loadAdminApplications() {
            const table = document.getElementById('adminApplicationsTable');
            table.innerHTML = '';
            
            applications.forEach(app => {
                const row = document.createElement('tr');
                row.className = 'border-b hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-4 py-3">${app.id}</td>
                    <td class="px-4 py-3">${app.fullName}</td>
                    <td class="px-4 py-3">${app.serviceName}</td>
                    <td class="px-4 py-3">${app.date}</td>
                    <td class="px-4 py-3">
                        <select onchange="updateApplicationStatus('${app.id}', this.value)" class="border rounded px-2 py-1 text-sm">
                            <option value="आवेदन प्राप्त" ${app.status === 'आवेदन प्राप्त' ? 'selected' : ''}>आवेदन प्राप्त</option>
                            <option value="प्रक्रिया में" ${app.status === 'प्रक्रिया में' ? 'selected' : ''}>प्रक्रिया में</option>
                            <option value="तैयार" ${app.status === 'तैयार' ? 'selected' : ''}>तैयार</option>
                            <option value="डिलीवर किया गया" ${app.status === 'डिलीवर किया गया' ? 'selected' : ''}>डिलीवर किया गया</option>
                        </select>
                    </td>
                    <td class="px-4 py-3">
                        <button onclick="viewApplication('${app.id}')" class="text-blue-600 hover:text-blue-800 mr-2">देखें</button>
                        <button onclick="deleteApplication('${app.id}')" class="text-red-600 hover:text-red-800">डिलीट</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        function loadAdminUsers() {
            const table = document.getElementById('adminUsersTable');
            table.innerHTML = '';
            
            // Show registered users
            registeredUsers.forEach((user, index) => {
                const userApps = applications.filter(app => app.userMobile === user.mobile);
                const row = document.createElement('tr');
                row.className = 'border-b hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-4 py-3">${user.id}</td>
                    <td class="px-4 py-3">${user.name}</td>
                    <td class="px-4 py-3">${user.mobile}</td>
                    <td class="px-4 py-3">${userApps.length}</td>
                    <td class="px-4 py-3">
                        <button onclick="viewUserDetails('${user.mobile}')" class="text-blue-600 hover:text-blue-800">देखें</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }

        function switchAdminTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.className = 'admin-tab py-4 text-gray-500 hover:text-gray-700';
            });
            document.querySelector(`[data-tab="${tabName}"]`).className = 'admin-tab py-4 border-b-2 border-purple-600 text-purple-600 font-semibold';
            
            // Show/hide content
            document.querySelectorAll('.admin-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            const contentMap = {
                'services': 'adminServices',
                'applications': 'adminApplications',
                'users': 'adminUsers',
                'settings': 'adminSettings'
            };
            
            document.getElementById(contentMap[tabName]).classList.remove('hidden');
        }

        function handleAddService(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const newService = {
                id: services.length + 1,
                name: formData.get('serviceName'),
                icon: 'fas fa-file-alt',
                fee: parseInt(formData.get('fee')),
                duration: `${formData.get('duration')} दिन`,
                description: formData.get('description') || 'सेवा विवरण',
                active: true
            };
            
            services.push(newService);
            loadServices();
            loadAdminServices();
            
            document.getElementById('addServiceModal').classList.add('hidden');
            e.target.reset();
            alert('नई सेवा सफलतापूर्वक जोड़ी गई!');
        }

        function toggleService(serviceId) {
            const service = services.find(s => s.id === serviceId);
            if (service) {
                service.active = !service.active;
                loadServices();
                loadAdminServices();
                if (currentUser && currentUser.type === 'user') {
                    loadUserServices();
                }
            }
        }

        function editService(serviceId) {
            alert('एडिट फीचर जल्द ही आएगा!');
        }

        function deleteService(serviceId) {
            if (confirm('क्या आप वाकई इस सेवा को डिलीट करना चाहते हैं?')) {
                services = services.filter(s => s.id !== serviceId);
                loadServices();
                loadAdminServices();
                if (currentUser && currentUser.type === 'user') {
                    loadUserServices();
                }
            }
        }

        function updateApplicationStatus(appId, newStatus) {
            const application = applications.find(app => app.id === appId);
            if (application) {
                application.status = newStatus;
                // Refresh user history if user is logged in
                if (currentUser && currentUser.type === 'user') {
                    loadUserApplicationHistory();
                }
                alert('स्टेटस अपडेट किया गया!');
            }
        }

        function viewApplication(appId) {
            const application = applications.find(app => app.id === appId);
            if (application) {
                alert(`आवेदन विवरण:\n\nID: ${application.id}\nनाम: ${application.fullName}\nसेवा: ${application.serviceName}\nमोबाइल: ${application.mobile}\nपता: ${application.address}\nस्टेटस: ${application.status}`);
            }
        }

        function deleteApplication(appId) {
            if (confirm('क्या आप वाकई इस आवेदन को डिलीट करना चाहते हैं?')) {
                applications = applications.filter(app => app.id !== appId);
                loadAdminApplications();
                loadAdminUsers();
            }
        }

        function viewUserDetails(mobile) {
            const user = registeredUsers.find(u => u.mobile === mobile);
            const userApps = applications.filter(app => app.userMobile === mobile);
            const details = userApps.map(app => `${app.serviceName} (${app.status})`).join('\n');
            
            if (user) {
                alert(`यूजर विवरण:\n\nनाम: ${user.name}\nमोबाइल: ${mobile}\nईमेल: ${user.email || 'N/A'}\nरजिस्ट्रेशन: ${new Date(user.createdAt).toLocaleDateString('hi-IN')}\nकुल आवेदन: ${userApps.length}\n\nसेवाएं:\n${details || 'कोई आवेदन नहीं'}`);
            }
        }

        // Database Functions (same as before)
        function selectDatabase(dbType, event = null) {
            document.querySelectorAll('.database-config').forEach(config => {
                config.classList.add('hidden');
            });
            
            document.querySelectorAll('[data-db]').forEach(card => {
                card.classList.remove('border-blue-500', 'bg-blue-50');
                card.classList.add('border-gray-200');
            });
            
            const configMap = {
                'sheets': 'sheetsConfig',
                'jsonbin': 'jsonbinConfig', 
                'firebase': 'firebaseConfig'
            };
            
            document.getElementById(configMap[dbType]).classList.remove('hidden');
            
            if (event) {
                const card = event.currentTarget;
                card.classList.add('border-blue-500', 'bg-blue-50');
                card.classList.remove('border-gray-200');
            } else {
                const card = document.querySelector(`[data-db="${dbType}"]`);
                if (card) {
                    card.classList.add('border-blue-500', 'bg-blue-50');
                    card.classList.remove('border-gray-200');
                }
            }
        }

        // Database Integration Variables
        let activeDatabase = null;
        let databaseConfig = null;

        async function saveUserToDatabase(user) {
            // Save user to configured database
            if (activeDatabase && databaseConfig) {
                try {
                    console.log('Saving user to database:', user.name);
                    // Implementation depends on selected database
                } catch (error) {
                    console.error('Error saving user to database:', error);
                }
            }
        }

        async function saveApplicationToDatabase(application) {
            if (!activeDatabase || !databaseConfig) {
                console.log('📝 No active database configured - saving locally only');
                return;
            }

            try {
                switch (activeDatabase) {
                    case 'jsonbin':
                        await saveToJsonBin(application);
                        break;
                    // Add other database cases as needed
                }
                console.log('💾 Application saved to', activeDatabase, 'database');
            } catch (error) {
                console.error('❌ Error saving to database:', error);
                throw error;
            }
        }

        async function saveToJsonBin(application) {
            const binId = databaseConfig.binId;
            const apiKey = databaseConfig.apiKey;
            
            if (!binId) {
                throw new Error('No Bin ID configured');
            }
            
            try {
                const getResponse = await fetch(`https://api.jsonbin.io/v3/b/${binId}`, {
                    headers: {
                        'X-Master-Key': apiKey
                    }
                });
                
                if (getResponse.ok) {
                    const currentData = await getResponse.json();
                    const data = currentData.record;
                    
                    if (!data.applications) data.applications = [];
                    if (!data.users) data.users = [];
                    
                    data.applications.push(application);
                    data.lastUpdated = new Date().toISOString();
                    
                    const updateResponse = await fetch(`https://api.jsonbin.io/v3/b/${binId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': apiKey
                        },
                        body: JSON.stringify(data)
                    });

                    if (!updateResponse.ok) {
                        throw new Error('Failed to update JSONBin');
                    }
                } else {
                    throw new Error('Failed to read from JSONBin');
                }
            } catch (error) {
                console.error('JSONBin save error:', error);
                throw error;
            }
        }

        // Placeholder functions for other database operations
        async function testSheetsConnection() { alert('Google Sheets टेस्ट फीचर जल्द आएगा!'); }
        async function saveSheetsConfig() { alert('Google Sheets कॉन्फ़िगरेशन जल्द आएगा!'); }
        async function testJsonbinConnection() { 
            const apiKey = document.getElementById('jsonbinApiKey').value;
            if (!apiKey) {
                alert('कृपया API Key दर्ज करें');
                return;
            }
            alert('JSONBin कनेक्शन टेस्ट सफल!');
        }
        async function saveJsonbinConfig() {
            const config = {
                type: 'jsonbin',
                apiKey: document.getElementById('jsonbinApiKey').value,
                binId: document.getElementById('jsonbinId').value,
                binName: document.getElementById('jsonbinName').value || 'mushtaq-store-data'
            };
            
            if (!config.apiKey) {
                alert('कृपया API Key दर्ज करें');
                return;
            }
            
            localStorage.setItem('databaseConfig', JSON.stringify(config));
            databaseConfig = config;
            activeDatabase = 'jsonbin';
            alert('✅ JSONBin कॉन्फ़िगरेशन सेव हो गई!');
        }
        async function testFirebaseConnection() { alert('Firebase टेस्ट फीचर जल्द आएगा!'); }
        async function saveFirebaseConfig() { alert('Firebase कॉन्फ़िगरेशन जल्द आएगा!'); }

        function showConnectionStatus(type, message) {
            console.log(`${type}: ${message}`);
        }

        function updateDatabaseStatus() {
            // Update database status display
        }

        function loadSavedConfig() {
            // Auto-configure JSONBin
            const jsonbinConfig = {
                type: 'jsonbin',
                apiKey: '$2a$10$bZUdNc0B9rx7.jxKMYrS/uT4sapfPsojmAKI97/GvC1JoeSW26F6m',
                binId: '',
                binName: 'mushtaq-store-data'
            };
            
            databaseConfig = jsonbinConfig;
            activeDatabase = 'jsonbin';
            localStorage.setItem('databaseConfig', JSON.stringify(jsonbinConfig));
            
            document.getElementById('jsonbinApiKey').value = jsonbinConfig.apiKey;
            document.getElementById('jsonbinId').value = jsonbinConfig.binId;
            document.getElementById('jsonbinName').value = jsonbinConfig.binName;
            
            selectDatabase('jsonbin');
            console.log('🗃️ JSONBin auto-configured');
        }

        function previewHomePageChanges() {
            const storeName = document.getElementById('storeName').value;
            const headline = document.getElementById('headline').value;
            const contactNumber = document.getElementById('contactNumber').value;
            
            alert(`होम पेज प्रीव्यू:\n\nस्टोर नाम: ${storeName}\nहेडलाइन: ${headline}\nसंपर्क: ${contactNumber}\n\nनोट: यह केवल प्रीव्यू है।`);
        }

        // Initialize the app
        initApp();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9835236c45a75994',t:'MTc1ODU3OTA5MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            font-size: 16px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
            border: 2px solid #e5e7eb;
        }
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        .service-card {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .service-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            border-color: #667eea;
        }
        .service-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 0.75rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
        }
        .admin-section {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .stats-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        .data-table th {
            background: #f9fafb;
            font-weight: 600;
            color: #374151;
        }
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
        .status-completed {
            background: #d1fae5;
            color: #065f46;
        }
        .status-processing {
            background: #dbeafe;
            color: #1e40af;
        }
        .hidden {
            display: none !important;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- Header -->
    <header class="gradient-bg text-white py-6 shadow-lg">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                        <span class="text-2xl">🏪</span>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold">Mushtaq Store</h1>
                        <p class="text-blue-100">Digital Services & Solutions</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <button onclick="showUserLogin()" class="btn btn-secondary">
                        👤 User Login
                    </button>
                    <button onclick="showTrackingModal()" class="btn btn-secondary">
                        📋 Track Application
                    </button>
                    <button onclick="showAdminLogin()" class="btn btn-secondary">
                        🔧 Admin
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Hero Section -->
        <section class="text-center mb-12">
            <div class="floating-animation inline-block mb-6">
                <div class="w-24 h-24 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-4xl text-white shadow-lg">
                    💼
                </div>
            </div>
            <h2 class="text-4xl font-bold text-gray-800 mb-4">
                सभी सरकारी सेवाएं एक जगह
            </h2>
            <p class="text-xl text-gray-600 max-w-2xl mx-auto mb-4">
                आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें
            </p>
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-w-md mx-auto">
                <p class="text-yellow-800 font-medium">
                    🔐 सेवाओं का उपयोग करने के लिए पहले <button onclick="showUserLogin()" class="text-blue-600 underline hover:text-blue-800">Login करें</button>
                </p>
            </div>
        </section>

        <!-- Services Grid -->
        <section id="servicesGridHomepage" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
            <!-- Services will be loaded dynamically -->
        </section>

        <!-- Features Section -->
        <section class="bg-white rounded-2xl p-8 shadow-lg mb-12">
            <h3 class="text-3xl font-bold text-center mb-8 text-gray-800">हमारी विशेषताएं</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">⚡</span>
                    </div>
                    <h4 class="text-xl font-bold mb-2">तेज़ सेवा</h4>
                    <p class="text-gray-600">24-48 घंटे में काम पूरा</p>
                </div>
                <div class="text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">🔒</span>
                    </div>
                    <h4 class="text-xl font-bold mb-2">सुरक्षित</h4>
                    <p class="text-gray-600">आपकी जानकारी पूर्णतः सुरक्षित</p>
                </div>
                <div class="text-center">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">💰</span>
                    </div>
                    <h4 class="text-xl font-bold mb-2">किफायती दर</h4>
                    <p class="text-gray-600">बाजार से कम दाम</p>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section class="bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-2xl p-8 text-center">
            <h3 class="text-3xl font-bold mb-4">संपर्क करें</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="text-xl font-bold mb-2">📞 फोन</h4>
                    <p class="text-lg">+91 93550 22066</p>
                </div>
                <div>
                    <h4 class="text-xl font-bold mb-2">📍 पता</h4>
                    <p class="text-lg">Mushtaq Store, Main Market</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Service Form Modal -->
    <div id="serviceModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 id="modalTitle" class="text-2xl font-bold text-gray-800"></h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form id="serviceForm" onsubmit="submitForm(event)">
                <div class="form-group">
                    <label class="form-label">सेवा का प्रकार *</label>
                    <select id="serviceType" class="form-input" required>
                        <option value="">सेवा चुनें</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">पूरा नाम *</label>
                    <input type="text" id="fullName" class="form-input" required>
                </div>

                <div class="form-group">
                    <label class="form-label">मोबाइल नंबर *</label>
                    <input type="tel" id="mobile" class="form-input" pattern="[0-9]{10}" required>
                </div>

                <div class="form-group">
                    <label class="form-label">ईमेल</label>
                    <input type="email" id="email" class="form-input">
                </div>

                <div class="form-group">
                    <label class="form-label">पूरा पता *</label>
                    <textarea id="address" class="form-input" rows="3" required></textarea>
                </div>

                <!-- Dynamic Fields Container -->
                <div id="dynamicFields"></div>

                <!-- File Upload Section -->
                <div class="form-group">
                    <label class="form-label">Upload Documents</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center bg-gray-50">
                        <div class="text-2xl mb-2">📁</div>
                        <p class="text-sm text-gray-600 mb-3">Upload required documents (PDF, JPG, PNG)</p>
                        <input type="file" id="serviceDocuments" class="hidden" multiple 
                               accept=".pdf,.jpg,.jpeg,.png" onchange="handleServiceDocuments(event)">
                        <button type="button" onclick="document.getElementById('serviceDocuments').click()" 
                                class="btn btn-secondary text-sm">
                            Choose Files
                        </button>
                        <p class="text-xs text-gray-500 mt-2">Max 5MB per file</p>
                    </div>
                    <div id="serviceUploadedFiles" class="mt-3 space-y-2">
                        <!-- Uploaded files will appear here -->
                    </div>
                </div>

                <div class="flex space-x-4">
                    <button type="submit" class="btn btn-primary flex-1">
                        <span id="submitText">आवेदन जमा करें</span>
                        <span id="submitLoader" class="loading hidden ml-2"></span>
                    </button>
                    <button type="button" onclick="closeModal()" class="btn btn-secondary">रद्द करें</button>
                    <button type="button" onclick="backToDashboard()" class="btn btn-secondary" id="backToDashboardBtn" style="display: none;">
                        📊 Dashboard
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Tracking Modal -->
    <div id="trackingModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">आवेदन ट्रैक करें</h3>
                <button onclick="closeTrackingModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form onsubmit="trackApplication(event)">
                <div class="form-group">
                    <label class="form-label">ट्रैकिंग आईडी</label>
                    <input type="text" id="trackingId" class="form-input" placeholder="MS-XXXXXX" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">मोबाइल नंबर</label>
                    <input type="tel" id="trackingMobile" class="form-input" pattern="[0-9]{10}" required>
                </div>

                <button type="submit" class="btn btn-primary w-full">ट्रैक करें</button>
            </form>

            <div id="trackingResult" class="hidden mt-6 p-4 bg-gray-50 rounded-lg"></div>
        </div>
    </div>

    <!-- User Login Modal -->
    <div id="userLoginModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">User Login</h3>
                <button onclick="closeUserLogin()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form onsubmit="userLogin(event)">
                <div class="form-group">
                    <label class="form-label">आपका नाम *</label>
                    <input type="text" id="userName" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">मोबाइल नंबर *</label>
                    <input type="tel" id="userMobile" class="form-input" pattern="[0-9]{10}" required>
                </div>

                <button type="submit" class="btn btn-primary w-full">Login / Register</button>
            </form>
            
            <p class="text-sm text-gray-600 mt-4 text-center">
                पहली बार? चिंता न करें - आपका account automatically बन जाएगा!
            </p>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">Admin Login</h3>
                <button onclick="closeAdminLogin()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form onsubmit="adminLogin(event)">
                <div class="form-group">
                    <label class="form-label">Admin ID</label>
                    <input type="text" id="adminId" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" id="adminPassword" class="form-input" required>
                </div>

                <button type="submit" class="btn btn-primary w-full">Login</button>
            </form>
        </div>
    </div>

    <!-- User Dashboard -->
    <div id="userDashboard" class="hidden fixed inset-0 bg-gray-100 z-50 overflow-y-auto">
        <div class="container mx-auto px-4 py-8">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-3xl font-bold text-gray-800">Welcome, <span id="currentUserName"></span>!</h2>
                    <p class="text-gray-600">आपकी सभी services और history यहाँ देखें</p>
                </div>
                <button onclick="logoutUser()" class="btn btn-secondary">Logout</button>
            </div>

            <!-- User Stats -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg p-6 shadow-lg">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                            <span class="text-2xl">📋</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Total Applications</h3>
                            <p class="text-2xl font-bold text-blue-600" id="userTotalApps">0</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg p-6 shadow-lg">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center mr-4">
                            <span class="text-2xl">⏳</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Pending</h3>
                            <p class="text-2xl font-bold text-yellow-600" id="userPendingApps">0</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-lg p-6 shadow-lg">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mr-4">
                            <span class="text-2xl">✅</span>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800">Completed</h3>
                            <p class="text-2xl font-bold text-green-600" id="userCompletedApps">0</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h3 class="text-xl font-bold mb-4">Quick Actions</h3>
                <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                    <button onclick="quickService('aadhaar')" class="p-4 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors">
                        <div class="text-2xl mb-2">🆔</div>
                        <div class="text-sm font-medium">Aadhaar</div>
                    </button>
                    <button onclick="quickService('pan')" class="p-4 bg-green-50 rounded-lg hover:bg-green-100 transition-colors">
                        <div class="text-2xl mb-2">💳</div>
                        <div class="text-sm font-medium">PAN Card</div>
                    </button>
                    <button onclick="quickService('voter')" class="p-4 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors">
                        <div class="text-2xl mb-2">🗳️</div>
                        <div class="text-sm font-medium">Voter ID</div>
                    </button>
                    <button onclick="quickService('ration')" class="p-4 bg-orange-50 rounded-lg hover:bg-orange-100 transition-colors">
                        <div class="text-2xl mb-2">🍚</div>
                        <div class="text-sm font-medium">Ration Card</div>
                    </button>
                    <button onclick="quickService('income')" class="p-4 bg-red-50 rounded-lg hover:bg-red-100 transition-colors">
                        <div class="text-2xl mb-2">📄</div>
                        <div class="text-sm font-medium">Certificates</div>
                    </button>
                    <button onclick="quickService('other')" class="p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                        <div class="text-2xl mb-2">⚙️</div>
                        <div class="text-sm font-medium">Other</div>
                    </button>
                </div>
            </div>

            <!-- Application History -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-xl font-bold mb-4">आपकी Application History</h3>
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Tracking ID</th>
                                <th>Service</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="userHistoryTable">
                            <!-- User applications will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div id="noApplications" class="text-center py-8 hidden">
                    <div class="text-6xl mb-4">📋</div>
                    <h4 class="text-xl font-semibold text-gray-600 mb-2">कोई application नहीं मिली</h4>
                    <p class="text-gray-500 mb-4">अभी तक आपने कोई service नहीं ली है</p>
                    <button onclick="logoutUser(); setTimeout(() => document.querySelector('.service-card').scrollIntoView({behavior: 'smooth'}), 500)" class="btn btn-primary">
                        पहली Service लें
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Service Modal -->
    <div id="serviceManagementModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="flex justify-between items-center mb-6">
                <h3 id="serviceModalTitle" class="text-2xl font-bold text-gray-800">Add New Service</h3>
                <button onclick="closeServiceModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <form id="serviceManagementForm" onsubmit="saveService(event)">
                <div class="form-group">
                    <label class="form-label">Service Name *</label>
                    <input type="text" id="serviceName" class="form-input" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Service Icon</label>
                    <select id="serviceIconSelect" class="form-input">
                        <option value="🆔">🆔 ID Card</option>
                        <option value="💳">💳 Credit Card</option>
                        <option value="🗳️">🗳️ Ballot Box</option>
                        <option value="🍚">🍚 Rice</option>
                        <option value="📄">📄 Document</option>
                        <option value="⚙️">⚙️ Gear</option>
                        <option value="🏦">🏦 Bank</option>
                        <option value="⚡">⚡ Lightning</option>
                        <option value="📱">📱 Mobile</option>
                        <option value="🔧">🔧 Tools</option>
                        <option value="💼">💼 Briefcase</option>
                        <option value="🎯">🎯 Target</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Service Description</label>
                    <textarea id="serviceDescription" class="form-input" rows="3" 
                              placeholder="Brief description of the service"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Service Options (one per line)</label>
                    <textarea id="serviceOptions" class="form-input" rows="4" 
                              placeholder="Option 1&#10;Option 2&#10;Option 3"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Price Range</label>
                    <input type="text" id="servicePrice" class="form-input" 
                           placeholder="₹50-200">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Service Image</label>
                    <input type="file" id="serviceImage" class="form-input" 
                           accept="image/*" onchange="handleServiceImageUpload(event)">
                    <p class="text-sm text-gray-500 mt-1">Upload service image (optional)</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Status</label>
                    <select id="serviceStatus" class="form-input">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>
                
                <div class="flex space-x-4">
                    <button type="submit" class="btn btn-primary flex-1">
                        💾 Save Service
                    </button>
                    <button type="button" onclick="closeServiceModal()" class="btn btn-secondary">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- File Upload Modal -->
    <div id="fileUploadModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">Upload Documents</h3>
                <button onclick="closeFileUploadModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            
            <div class="space-y-4">
                <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center" id="dropZone">
                    <div class="text-4xl mb-4">📁</div>
                    <p class="text-gray-600 mb-4">Drag & drop files here or click to browse</p>
                    <input type="file" id="documentUpload" class="hidden" multiple 
                           accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileUpload(event)">
                    <button onclick="document.getElementById('documentUpload').click()" class="btn btn-primary">
                        Choose Files
                    </button>
                    <p class="text-sm text-gray-500 mt-2">Supported: PDF, JPG, PNG (Max 5MB each)</p>
                </div>
                
                <div id="uploadedFiles" class="space-y-2">
                    <!-- Uploaded files will appear here -->
                </div>
            </div>
            
            <div class="flex justify-end space-x-4 mt-6">
                <button onclick="closeFileUploadModal()" class="btn btn-secondary">Done</button>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden fixed inset-0 bg-gray-100 z-50 overflow-y-auto">
        <div class="container mx-auto px-4 py-8">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800">Admin Dashboard</h2>
                <button onclick="logoutAdmin()" class="btn btn-secondary">Logout</button>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="stats-card">
                    <h3 class="text-lg font-semibold mb-2">कुल आवेदन</h3>
                    <p class="text-3xl font-bold" id="totalApplications">0</p>
                </div>
                <div class="stats-card">
                    <h3 class="text-lg font-semibold mb-2">पेंडिंग</h3>
                    <p class="text-3xl font-bold" id="pendingApplications">0</p>
                </div>
                <div class="stats-card">
                    <h3 class="text-lg font-semibold mb-2">प्रोसेसिंग</h3>
                    <p class="text-3xl font-bold" id="processingApplications">0</p>
                </div>
                <div class="stats-card">
                    <h3 class="text-lg font-semibold mb-2">पूर्ण</h3>
                    <p class="text-3xl font-bold" id="completedApplications">0</p>
                </div>
            </div>

            <!-- Admin Tabs -->
            <div class="bg-white rounded-lg shadow-lg">
                <div class="border-b border-gray-200">
                    <nav class="flex space-x-8 px-6 overflow-x-auto">
                        <button onclick="showAdminTab('applications')" class="admin-tab-btn py-4 px-2 border-b-2 border-blue-500 text-blue-600 font-medium whitespace-nowrap">
                            Applications
                        </button>
                        <button onclick="showAdminTab('services')" class="admin-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap">
                            Services
                        </button>
                        <button onclick="showAdminTab('herosection')" class="admin-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap">
                            Website Customizer
                        </button>
                        <button onclick="showAdminTab('users')" class="admin-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap">
                            Users
                        </button>
                        <button onclick="showAdminTab('settings')" class="admin-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap">
                            Settings
                        </button>
                        <button onclick="showAdminTab('googlesheets')" class="admin-tab-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 whitespace-nowrap">
                            Google Sheets
                        </button>
                    </nav>
                </div>

                <!-- Applications Tab -->
                <div id="applicationsTab" class="admin-section">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">All Applications</h3>
                        <div class="flex space-x-2">
                            <select id="statusFilter" onchange="filterApplications()" class="form-input">
                                <option value="">All Status</option>
                                <option value="आवेदन प्राप्त">Pending</option>
                                <option value="प्रोसेसिंग में">Processing</option>
                                <option value="पूर्ण">Completed</option>
                            </select>
                            <button onclick="exportData()" class="btn btn-secondary">Export CSV</button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Tracking ID</th>
                                    <th>Name</th>
                                    <th>Service</th>
                                    <th>Mobile</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="applicationsTableBody">
                                <!-- Applications will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Services Tab -->
                <div id="servicesTab" class="admin-section hidden">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold">Services Management</h3>
                        <button onclick="showAddServiceModal()" class="btn btn-primary">
                            ➕ Add New Service
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="servicesGrid">
                        <!-- Services will be loaded here -->
                    </div>
                </div>

                <!-- Website Customizer Tab -->
                <div id="herosectionTab" class="admin-section hidden">
                    <h3 class="text-xl font-bold mb-6">Website Customizer</h3>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <!-- Settings Panel -->
                        <div class="space-y-6">
                            <!-- Hero Section Settings -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="font-semibold mb-4">🎯 Hero Section</h4>
                                
                                <div class="form-group">
                                    <label class="form-label">Hero Title</label>
                                    <input type="text" id="heroTitle" class="form-input" 
                                           value="सभी सरकारी सेवाएं एक जगह"
                                           placeholder="Enter hero title">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Hero Subtitle</label>
                                    <textarea id="heroSubtitle" class="form-input" rows="3" 
                                              placeholder="Enter hero subtitle">आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें</textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Hero Icon</label>
                                    <select id="heroIcon" class="form-input">
                                        <option value="💼">💼 Briefcase</option>
                                        <option value="🏪">🏪 Store</option>
                                        <option value="📋">📋 Clipboard</option>
                                        <option value="⚡">⚡ Lightning</option>
                                        <option value="🎯">🎯 Target</option>
                                        <option value="🔧">🔧 Tools</option>
                                        <option value="📱">📱 Mobile</option>
                                        <option value="💻">💻 Computer</option>
                                        <option value="🌟">🌟 Star</option>
                                        <option value="🚀">🚀 Rocket</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Background Image</label>
                                    <input type="file" id="heroBackground" class="form-input" 
                                           accept="image/*" onchange="handleHeroImageUpload(event)">
                                    <p class="text-sm text-gray-500 mt-1">Upload background image (optional)</p>
                                </div>
                            </div>

                            <!-- Header Settings -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="font-semibold mb-4">🏢 Header Settings</h4>
                                
                                <div class="form-group">
                                    <label class="form-label">Store Name</label>
                                    <input type="text" id="storeName" class="form-input" 
                                           value="Mushtaq Store"
                                           placeholder="Enter store name">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Store Tagline</label>
                                    <input type="text" id="storeTagline" class="form-input" 
                                           value="Digital Services & Solutions"
                                           placeholder="Enter store tagline">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Store Icon</label>
                                    <select id="storeIcon" class="form-input">
                                        <option value="🏪">🏪 Store</option>
                                        <option value="🏢">🏢 Office</option>
                                        <option value="💼">💼 Business</option>
                                        <option value="🎯">🎯 Target</option>
                                        <option value="⚡">⚡ Lightning</option>
                                        <option value="🔧">🔧 Service</option>
                                        <option value="📱">📱 Digital</option>
                                        <option value="💻">💻 Tech</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Contact Settings -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="font-semibold mb-4">📞 Contact Information</h4>
                                
                                <div class="form-group">
                                    <label class="form-label">Phone Number</label>
                                    <input type="tel" id="contactPhone" class="form-input" 
                                           value="+91 93550 22066"
                                           placeholder="Enter phone number">
                                </div>
                                
                                <div class="form-group">
                                    <label class="form-label">Address</label>
                                    <textarea id="contactAddress" class="form-input" rows="2" 
                                              placeholder="Enter address">Mushtaq Store, Main Market</textarea>
                                </div>
                            </div>
                                
                            <div class="flex space-x-4">
                                <button onclick="saveWebsiteSettings()" class="btn btn-primary">
                                    💾 Save All Changes
                                </button>
                                <button onclick="resetWebsiteSettings()" class="btn btn-secondary">
                                    🔄 Reset to Default
                                </button>
                                <button onclick="previewWebsite()" class="btn btn-secondary">
                                    👁️ Full Preview
                                </button>
                            </div>
                        </div>
                        
                        <!-- Live Preview -->
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <div class="flex justify-between items-center mb-4">
                                <h4 class="font-semibold">🖥️ Live Website Preview</h4>
                                <button onclick="refreshPreview()" class="text-blue-600 hover:text-blue-800 text-sm">
                                    🔄 Refresh
                                </button>
                            </div>
                            <div class="border-2 border-gray-300 rounded-lg bg-white overflow-hidden" style="height: 600px;">
                                <iframe id="websitePreview" src="about:blank" class="w-full h-full border-0" 
                                        style="transform: scale(0.7); transform-origin: top left; width: 142.86%; height: 142.86%;">
                                </iframe>
                            </div>
                            <p class="text-xs text-gray-500 mt-2 text-center">
                                Preview shows your website at 70% scale. Click "Full Preview" for actual size.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Users Tab -->
                <div id="usersTab" class="admin-section hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Registered Users</h3>
                        <div class="flex space-x-2">
                            <button onclick="exportUsers()" class="btn btn-secondary">Export Users CSV</button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>User ID</th>
                                    <th>Name</th>
                                    <th>Mobile</th>
                                    <th>Registered Date</th>
                                    <th>Last Login</th>
                                    <th>Total Applications</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <!-- Users will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div id="settingsTab" class="admin-section hidden">
                    <h3 class="text-xl font-bold mb-4">System Settings</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold mb-2">Contact Information</h4>
                            <div class="form-group">
                                <label class="form-label">Phone Number</label>
                                <input type="tel" id="contactPhone" class="form-input" value="+91 93550 22066">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Address</label>
                                <textarea id="contactAddress" class="form-input" rows="3">Mushtaq Store, Main Market</textarea>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-semibold mb-2">Service Pricing</h4>
                            <div class="form-group">
                                <label class="form-label">Aadhaar Services (₹)</label>
                                <input type="text" id="aadhaarPrice" class="form-input" value="50-200">
                            </div>
                            <div class="form-group">
                                <label class="form-label">PAN Card Services (₹)</label>
                                <input type="text" id="panPrice" class="form-input" value="100-300">
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="saveSettings()" class="btn btn-primary mt-4">Save Settings</button>
                </div>

                <!-- Google Sheets Tab -->
                <div id="googlesheetsTab" class="admin-section hidden">
                    <h3 class="text-xl font-bold mb-4">Google Sheets Integration</h3>
                    
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                        <h4 class="font-semibold text-blue-800 mb-2">Current Configuration</h4>
                        <p class="text-sm text-blue-700 mb-2">
                            <strong>Apps Script URL:</strong><br>
                            <code class="bg-white px-2 py-1 rounded text-xs">https://script.google.com/macros/s/AKfycbwvHHNlME_FyFQGlG-LLEN8CdvzMlF7b2autQ5lIMBrSCyDOWH1FBK5jVQcH8-DTLHb/exec</code>
                        </p>
                        <p class="text-sm text-blue-700">
                            <strong>Sheet ID:</strong><br>
                            <code class="bg-white px-2 py-1 rounded text-xs">1jZDzT8Iy1XF1pV0fm0kS-XxxAg3T1_wxss89fy_qx5A</code>
                        </p>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Google Apps Script URL</label>
                        <input type="url" id="googleScriptUrl" class="form-input" 
                               value="https://script.google.com/macros/s/AKfycbwvHHNlME_FyFQGlG-LLEN8CdvzMlF7b2autQ5lIMBrSCyDOWH1FBK5jVQcH8-DTLHb/exec"
                               placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Google Sheet ID</label>
                        <input type="text" id="googleSheetId" class="form-input" 
                               value="1jZDzT8Iy1XF1pV0fm0kS-XxxAg3T1_wxss89fy_qx5A"
                               placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms">
                    </div>
                    
                    <div class="flex space-x-4">
                        <button onclick="saveGoogleSheetsConfig()" class="btn btn-primary">Save Configuration</button>
                        <button onclick="testGoogleSheets()" class="btn btn-secondary">Test Connection</button>
                    </div>

                    <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                        <h4 class="font-semibold mb-2">Apps Script Code</h4>
                        <p class="text-sm text-gray-600 mb-2">Copy this code to your Google Apps Script:</p>
                        <pre class="bg-gray-800 text-green-400 p-4 rounded text-xs overflow-x-auto"><code>function doPost(e) {
  try {
    const SHEET_ID = '1jZDzT8Iy1XF1pV0fm0kS-XxxAg3T1_wxss89fy_qx5A';
    const sheet = SpreadsheetApp.openById(SHEET_ID).getActiveSheet();
    
    const data = JSON.parse(e.postData.contents);
    
    sheet.appendRow([
      new Date().toLocaleString('hi-IN'),
      data.trackingId || '',
      data.serviceType || '',
      data.fullName || '',
      data.mobile || '',
      data.email || '',
      data.address || '',
      data.status || 'आवेदन प्राप्त',
      data.fatherName || '',
      data.dob || '',
      data.aadhaarNumber || ''
    ]);
    
    return ContentService
      .createTextOutput(JSON.stringify({success: true}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch (error) {
    return ContentService
      .createTextOutput(JSON.stringify({success: false, error: error.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

function doGet() {
  return ContentService.createTextOutput('Apps Script is working!');
}</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentService = '';
        let applications = JSON.parse(localStorage.getItem('applications') || '[]');
        let users = JSON.parse(localStorage.getItem('users') || '[]');
        let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
        let isAdminLoggedIn = false;
        let isUserLoggedIn = false;
        let customServices = JSON.parse(localStorage.getItem('customServices') || '[]');
        let heroSettings = JSON.parse(localStorage.getItem('heroSettings') || '{}');
        let currentEditingService = null;
        let uploadedDocuments = [];

        // Google Sheets Configuration
        const GOOGLE_SHEETS_CONFIG = {
            scriptUrl: 'https://script.google.com/macros/s/AKfycbwvHHNlME_FyFQGlG-LLEN8CdvzMlF7b2autQ5lIMBrSCyDOWH1FBK5jVQcH8-DTLHb/exec',
            sheetId: '1jZDzT8Iy1XF1pV0fm0kS-XxxAg3T1_wxss89fy_qx5A'
        };

        // Check if user is logged in before opening service
        function checkLoginAndOpenService(service) {
            if (!isUserLoggedIn || !currentUser) {
                showNotification('⚠️ सेवा का उपयोग करने के लिए पहले Login करें!', 'error');
                setTimeout(() => {
                    showUserLogin();
                }, 1000);
                return;
            }
            openServiceForm(service);
        }

        // Service configurations
        const serviceConfigs = {
            aadhaar: {
                title: 'आधार कार्ड सेवाएं',
                options: [
                    'नया आधार कार्ड',
                    'आधार अपडेट/सुधार',
                    'मोबाइल नंबर लिंक',
                    'आधार डाउनलोड',
                    'बायोमेट्रिक अपडेट'
                ],
                fields: [
                    { id: 'fatherName', label: 'पिता का नाम', type: 'text', required: true },
                    { id: 'dob', label: 'जन्म तिथि', type: 'date', required: true },
                    { id: 'aadhaarNumber', label: 'आधार नंबर (यदि है)', type: 'text', required: false }
                ]
            },
            pan: {
                title: 'पैन कार्ड सेवाएं',
                options: [
                    'नया पैन कार्ड',
                    'पैन कार्ड सुधार',
                    'डुप्लिकेट पैन कार्ड',
                    'पैन स्टेटस चेक'
                ],
                fields: [
                    { id: 'fatherName', label: 'पिता का नाम', type: 'text', required: true },
                    { id: 'dob', label: 'जन्म तिथि', type: 'date', required: true },
                    { id: 'panNumber', label: 'पैन नंबर (यदि है)', type: 'text', required: false }
                ]
            },
            voter: {
                title: 'वोटर आईडी सेवाएं',
                options: [
                    'नई वोटर आईडी',
                    'वोटर आईडी सुधार',
                    'पता बदलाव',
                    'डुप्लिकेट वोटर आईडी'
                ],
                fields: [
                    { id: 'fatherName', label: 'पिता का नाम', type: 'text', required: true },
                    { id: 'dob', label: 'जन्म तिथि', type: 'date', required: true },
                    { id: 'constituency', label: 'निर्वाचन क्षेत्र', type: 'text', required: true }
                ]
            },
            ration: {
                title: 'राशन कार्ड सेवाएं',
                options: [
                    'नया राशन कार्ड',
                    'राशन कार्ड सुधार',
                    'सदस्य जोड़ना',
                    'सदस्य हटाना',
                    'राशन कार्ड ट्रांसफर'
                ],
                fields: [
                    { id: 'fatherName', label: 'पिता का नाम', type: 'text', required: true },
                    { id: 'familyMembers', label: 'परिवार के सदस्य', type: 'number', required: true },
                    { id: 'rationCard', label: 'राशन कार्ड नंबर (यदि है)', type: 'text', required: false }
                ]
            },
            income: {
                title: 'प्रमाण पत्र सेवाएं',
                options: [
                    'आय प्रमाण पत्र',
                    'जाति प्रमाण पत्र',
                    'निवास प्रमाण पत्र',
                    'चरित्र प्रमाण पत्र'
                ],
                fields: [
                    { id: 'fatherName', label: 'पिता का नाम', type: 'text', required: true },
                    { id: 'occupation', label: 'व्यवसाय', type: 'text', required: true },
                    { id: 'annualIncome', label: 'वार्षिक आय', type: 'text', required: false }
                ]
            },
            other: {
                title: 'अन्य सेवाएं',
                options: [
                    'बैंक खाता खोलना',
                    'बिजली कनेक्शन',
                    'गैस कनेक्शन',
                    'मोबाइल रिचार्ज',
                    'बीमा सेवाएं'
                ],
                fields: [
                    { id: 'bankAccount', label: 'बैंक खाता नंबर', type: 'text', required: false },
                    { id: 'ifsc', label: 'IFSC कोड', type: 'text', required: false }
                ]
            }
        };

        // Utility Functions
        function generateTrackingId() {
            const prefix = 'MS';
            const timestamp = Date.now().toString().slice(-6);
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `${prefix}-${timestamp}${random}`;
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        function formatDate(date) {
            return new Date(date).toLocaleDateString('hi-IN');
        }

        // Modal Functions
        function openServiceForm(service) {
            currentService = service;
            
            // Check if it's a custom service
            const customService = customServices.find(s => s.id === service);
            const config = customService || serviceConfigs[service];
            
            if (!config) {
                showNotification('Service configuration not found!', 'error');
                return;
            }
            
            document.getElementById('modalTitle').textContent = customService ? customService.name : config.title;
            
            // Show/hide back to dashboard button based on user login status
            const backBtn = document.getElementById('backToDashboardBtn');
            if (isUserLoggedIn && currentUser) {
                backBtn.style.display = 'block';
                // Pre-fill user details if logged in
                if (currentUser.name) document.getElementById('fullName').value = currentUser.name;
                if (currentUser.mobile) document.getElementById('mobile').value = currentUser.mobile;
            } else {
                backBtn.style.display = 'none';
            }
            
            // Populate service options
            const serviceSelect = document.getElementById('serviceType');
            serviceSelect.innerHTML = '<option value="">सेवा चुनें</option>';
            
            const options = customService ? customService.options : config.options;
            if (options && options.length > 0) {
                options.forEach(option => {
                    serviceSelect.innerHTML += `<option value="${option}">${option}</option>`;
                });
            }
            
            // Generate dynamic fields
            const dynamicFields = document.getElementById('dynamicFields');
            dynamicFields.innerHTML = '';
            
            const fields = customService ? [] : (config.fields || []);
            fields.forEach(field => {
                const fieldHtml = `
                    <div class="form-group">
                        <label class="form-label">${field.label} ${field.required ? '*' : ''}</label>
                        <input type="${field.type}" id="${field.id}" class="form-input" ${field.required ? 'required' : ''}>
                    </div>
                `;
                dynamicFields.innerHTML += fieldHtml;
            });
            
            document.getElementById('serviceModal').classList.add('show');
        }

        function backToDashboard() {
            closeModal();
            showUserDashboard();
        }

        function closeModal() {
            document.getElementById('serviceModal').classList.remove('show');
            document.getElementById('serviceForm').reset();
            // Keep header as is - no changes needed
        }

        function showTrackingModal() {
            document.getElementById('trackingModal').classList.add('show');
        }

        function closeTrackingModal() {
            document.getElementById('trackingModal').classList.remove('show');
            document.getElementById('trackingResult').classList.add('hidden');
        }

        function showAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('show');
        }

        function closeAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('show');
        }

        // Form Submission
        async function submitForm(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('submitText');
            const loader = document.getElementById('submitLoader');
            
            submitBtn.textContent = 'जमा हो रहा है...';
            loader.classList.remove('hidden');
            
            try {
                const formData = new FormData(event.target);
                const trackingId = generateTrackingId();
                
                // Collect all form data
                const applicationData = {
                    trackingId: trackingId,
                    serviceType: document.getElementById('serviceType').value,
                    fullName: document.getElementById('fullName').value,
                    mobile: document.getElementById('mobile').value,
                    email: document.getElementById('email').value,
                    address: document.getElementById('address').value,
                    timestamp: new Date().toISOString(),
                    status: 'आवेदन प्राप्त',
                    userId: currentUser ? currentUser.id : null
                };
                
                // Add dynamic fields
                const config = serviceConfigs[currentService];
                config.fields.forEach(field => {
                    const element = document.getElementById(field.id);
                    if (element) {
                        applicationData[field.id] = element.value;
                    }
                });
                
                // Add uploaded documents
                if (uploadedDocuments.length > 0) {
                    applicationData.uploadedDocuments = uploadedDocuments;
                }
                
                // If user is logged in, auto-fill their details and create user if needed
                if (isUserLoggedIn && currentUser) {
                    applicationData.userId = currentUser.id;
                } else {
                    // Check if user exists with this mobile number
                    const mobile = applicationData.mobile;
                    let user = users.find(u => u.mobile === mobile);
                    
                    if (!user) {
                        // Create new user automatically
                        user = {
                            id: Date.now().toString(),
                            name: applicationData.fullName,
                            mobile: mobile,
                            registeredDate: new Date().toISOString(),
                            lastLogin: new Date().toISOString()
                        };
                        users.push(user);
                        localStorage.setItem('users', JSON.stringify(users));
                    }
                    applicationData.userId = user.id;
                }
                
                // Save to local storage
                applications.push(applicationData);
                localStorage.setItem('applications', JSON.stringify(applications));
                
                // Submit to Google Sheets
                await submitToGoogleSheets(applicationData);
                
                showNotification(`आवेदन सफलतापूर्वक जमा हुआ! ट्रैकिंग आईडी: ${trackingId}`);
                
                // Clear uploaded documents
                uploadedDocuments = [];
                document.getElementById('serviceUploadedFiles').innerHTML = '';
                
                closeModal();
                
                // If user is logged in, refresh their dashboard and show it
                if (isUserLoggedIn && currentUser) {
                    setTimeout(() => {
                        showUserDashboard();
                        loadUserData();
                    }, 1000);
                }
                
            } catch (error) {
                console.error('Submission error:', error);
                showNotification('आवेदन जमा करने में त्रुटि हुई। कृपया पुनः प्रयास करें।', 'error');
            } finally {
                submitBtn.textContent = 'आवेदन जमा करें';
                loader.classList.add('hidden');
            }
        }

        // Google Sheets Integration
        async function submitToGoogleSheets(data) {
            try {
                const sheetData = {
                    timestamp: new Date().toLocaleString('hi-IN'),
                    trackingId: data.trackingId,
                    serviceType: data.serviceType,
                    fullName: data.fullName,
                    mobile: data.mobile,
                    email: data.email || '',
                    address: data.address,
                    status: data.status,
                    fatherName: data.fatherName || '',
                    dob: data.dob || '',
                    aadhaarNumber: data.aadhaarNumber || '',
                    panNumber: data.panNumber || '',
                    constituency: data.constituency || '',
                    familyMembers: data.familyMembers || '',
                    rationCard: data.rationCard || '',
                    occupation: data.occupation || '',
                    annualIncome: data.annualIncome || '',
                    bankAccount: data.bankAccount || '',
                    ifsc: data.ifsc || ''
                };

                const response = await fetch(GOOGLE_SHEETS_CONFIG.scriptUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(sheetData)
                });

                console.log('Data submitted to Google Sheets');
                
            } catch (error) {
                console.error('Google Sheets submission error:', error);
                // Don't throw error to prevent blocking local storage
            }
        }

        // Application Tracking
        function trackApplication(event) {
            event.preventDefault();
            
            const trackingId = document.getElementById('trackingId').value.trim();
            const mobile = document.getElementById('trackingMobile').value.trim();
            
            const application = applications.find(app => 
                app.trackingId === trackingId && app.mobile === mobile
            );
            
            const resultDiv = document.getElementById('trackingResult');
            
            if (application) {
                resultDiv.innerHTML = `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <h4 class="font-bold text-green-800 mb-2">आवेदन मिला!</h4>
                        <div class="space-y-2 text-sm">
                            <p><strong>ट्रैकिंग आईडी:</strong> ${application.trackingId}</p>
                            <p><strong>नाम:</strong> ${application.fullName}</p>
                            <p><strong>सेवा:</strong> ${application.serviceType}</p>
                            <p><strong>दिनांक:</strong> ${formatDate(application.timestamp)}</p>
                            <p><strong>स्थिति:</strong> <span class="status-badge status-${application.status === 'आवेदन प्राप्त' ? 'pending' : application.status === 'प्रोसेसिंग में' ? 'processing' : 'completed'}">${application.status}</span></p>
                        </div>
                    </div>
                `;
                resultDiv.classList.remove('hidden');
            } else {
                resultDiv.innerHTML = `
                    <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                        <h4 class="font-bold text-red-800 mb-2">आवेदन नहीं मिला</h4>
                        <p class="text-sm text-red-600">कृपया ट्रैकिंग आईडी और मोबाइल नंबर की जांच करें।</p>
                    </div>
                `;
                resultDiv.classList.remove('hidden');
            }
        }

        // User Functions
        function showUserLogin() {
            document.getElementById('userLoginModal').classList.add('show');
        }

        function closeUserLogin() {
            document.getElementById('userLoginModal').classList.remove('show');
        }

        function userLogin(event) {
            event.preventDefault();
            
            const name = document.getElementById('userName').value.trim();
            const mobile = document.getElementById('userMobile').value.trim();
            
            if (!name || !mobile) {
                showNotification('कृपया नाम और मोबाइल नंबर डालें', 'error');
                return;
            }
            
            if (mobile.length !== 10) {
                showNotification('कृपया 10 अंकों का मोबाइल नंबर डालें', 'error');
                return;
            }
            
            // Check if user exists with exact name and mobile combination
            let user = users.find(u => u.mobile === mobile && u.name.toLowerCase() === name.toLowerCase());
            
            if (!user) {
                // Check if mobile exists with different name
                const existingMobile = users.find(u => u.mobile === mobile);
                
                if (existingMobile) {
                    showNotification(`❌ इस नंबर से पहले "${existingMobile.name}" नाम से account बना है। कृपया वही नाम डालें या अलग नंबर use करें।`, 'error');
                    return;
                }
                
                // Create new user - first time registration
                user = {
                    id: Date.now().toString(),
                    name: name,
                    mobile: mobile,
                    registeredDate: new Date().toISOString(),
                    lastLogin: new Date().toISOString()
                };
                users.push(user);
                localStorage.setItem('users', JSON.stringify(users));
                showNotification(`🎉 स्वागत है ${name}! आपका नया account बन गया है।`);
            } else {
                // Existing user with correct name and mobile
                user.lastLogin = new Date().toISOString();
                localStorage.setItem('users', JSON.stringify(users));
                showNotification(`🏠 स्वागत वापसी ${name}! आपकी history load हो रही है...`);
            }
            
            // Set current user
            currentUser = user;
            isUserLoggedIn = true;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            
            closeUserLogin();
            updateHeaderForLoggedInUser();
            showUserDashboard();
        }

        function showUserDashboard() {
            document.getElementById('userDashboard').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            
            // Update user name in dashboard
            document.getElementById('currentUserName').textContent = currentUser.name;
            
            // Load user data
            loadUserData();
        }

        function logoutUser() {
            isUserLoggedIn = false;
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('userDashboard').classList.add('hidden');
            document.body.style.overflow = 'auto';
            
            // Reset header to original state
            const headerButtons = document.querySelector('header .flex.items-center.space-x-4');
            headerButtons.innerHTML = `
                <button onclick="showUserLogin()" class="btn btn-secondary">
                    👤 User Login
                </button>
                <button onclick="showTrackingModal()" class="btn btn-secondary">
                    📋 Track Application
                </button>
                <button onclick="showAdminLogin()" class="btn btn-secondary">
                    🔧 Admin
                </button>
            `;
            
            showNotification('Successfully logged out!');
        }

        function loadUserData() {
            // Get user's applications
            const userApps = applications.filter(app => app.mobile === currentUser.mobile);
            
            // Update stats
            const total = userApps.length;
            const pending = userApps.filter(app => app.status === 'आवेदन प्राप्त' || app.status === 'प्रोसेसिंग में').length;
            const completed = userApps.filter(app => app.status === 'पूर्ण').length;
            
            document.getElementById('userTotalApps').textContent = total;
            document.getElementById('userPendingApps').textContent = pending;
            document.getElementById('userCompletedApps').textContent = completed;
            
            // Load history table
            loadUserHistory(userApps);
        }

        function loadUserHistory(userApps) {
            const tbody = document.getElementById('userHistoryTable');
            const noAppsDiv = document.getElementById('noApplications');
            
            if (userApps.length === 0) {
                tbody.innerHTML = '';
                noAppsDiv.classList.remove('hidden');
                return;
            }
            
            noAppsDiv.classList.add('hidden');
            tbody.innerHTML = '';
            
            // Sort by date (newest first)
            userApps.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            userApps.forEach(app => {
                const statusClass = app.status === 'आवेदन प्राप्त' ? 'pending' : 
                                  app.status === 'प्रोसेसिंग में' ? 'processing' : 'completed';
                
                const row = `
                    <tr>
                        <td class="font-mono text-sm">${app.trackingId}</td>
                        <td>${app.serviceType}</td>
                        <td>${formatDate(app.timestamp)}</td>
                        <td><span class="status-badge status-${statusClass}">${app.status}</span></td>
                        <td>
                            <button onclick="viewUserApplication('${app.trackingId}')" class="text-blue-600 hover:text-blue-800">
                                View Details
                            </button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function quickService(service) {
            // Close user dashboard and open service form directly
            document.getElementById('userDashboard').classList.add('hidden');
            document.body.style.overflow = 'auto';
            setTimeout(() => {
                openServiceForm(service);
            }, 300);
        }

        function updateHeaderForLoggedInUser() {
            const headerButtons = document.querySelector('header .flex.items-center.space-x-4');
            if (currentUser && isUserLoggedIn) {
                headerButtons.innerHTML = `
                    <div class="text-right mr-4">
                        <p class="text-sm text-blue-100">Welcome back!</p>
                        <p class="font-semibold">${currentUser.name}</p>
                    </div>
                    <button onclick="showUserDashboard()" class="btn btn-secondary">
                        📊 Dashboard
                    </button>
                    <button onclick="showTrackingModal()" class="btn btn-secondary">
                        📋 Track Application
                    </button>
                    <button onclick="logoutUser()" class="btn btn-secondary">
                        🚪 Logout
                    </button>
                `;
            }
        }

        function viewUserApplication(trackingId) {
            const app = applications.find(a => a.trackingId === trackingId);
            if (!app) return;
            
            const modalContent = `
                <div class="modal show" style="display: flex; align-items: center; justify-content: center;">
                    <div class="modal-content">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-gray-800">Application Details</h3>
                            <button onclick="this.closest('.modal').remove()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                        </div>
                        
                        <div class="space-y-4">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="font-semibold text-gray-700">Tracking ID:</label>
                                    <p class="font-mono text-sm bg-gray-100 p-2 rounded">${app.trackingId}</p>
                                </div>
                                <div>
                                    <label class="font-semibold text-gray-700">Status:</label>
                                    <p><span class="status-badge status-${app.status === 'आवेदन प्राप्त' ? 'pending' : app.status === 'प्रोसेसिंग में' ? 'processing' : 'completed'}">${app.status}</span></p>
                                </div>
                            </div>
                            
                            <div>
                                <label class="font-semibold text-gray-700">Service Type:</label>
                                <p>${app.serviceType}</p>
                            </div>
                            
                            <div>
                                <label class="font-semibold text-gray-700">Application Date:</label>
                                <p>${formatDate(app.timestamp)}</p>
                            </div>
                            
                            <div>
                                <label class="font-semibold text-gray-700">Full Name:</label>
                                <p>${app.fullName}</p>
                            </div>
                            
                            <div>
                                <label class="font-semibold text-gray-700">Mobile:</label>
                                <p>${app.mobile}</p>
                            </div>
                            
                            ${app.email ? `
                            <div>
                                <label class="font-semibold text-gray-700">Email:</label>
                                <p>${app.email}</p>
                            </div>
                            ` : ''}
                            
                            <div>
                                <label class="font-semibold text-gray-700">Address:</label>
                                <p>${app.address}</p>
                            </div>
                            
                            ${app.fatherName ? `
                            <div>
                                <label class="font-semibold text-gray-700">Father's Name:</label>
                                <p>${app.fatherName}</p>
                            </div>
                            ` : ''}
                            
                            ${app.dob ? `
                            <div>
                                <label class="font-semibold text-gray-700">Date of Birth:</label>
                                <p>${app.dob}</p>
                            </div>
                            ` : ''}
                        </div>
                        
                        <div class="mt-6 flex justify-end">
                            <button onclick="this.closest('.modal').remove()" class="btn btn-secondary">Close</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalContent);
        }

        // Admin Functions
        function adminLogin(event) {
            event.preventDefault();
            
            const adminId = document.getElementById('adminId').value;
            const password = document.getElementById('adminPassword').value;
            
            // Simple admin credentials (in production, use proper authentication)
            if (adminId === '2206' && password === '9355') {
                isAdminLoggedIn = true;
                closeAdminLogin();
                showAdminDashboard();
                loadAdminData();
            } else {
                showNotification('गलत Admin ID या Password', 'error');
            }
        }

        function showAdminDashboard() {
            document.getElementById('adminDashboard').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function logoutAdmin() {
            isAdminLoggedIn = false;
            document.getElementById('adminDashboard').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        function showAdminTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.admin-section').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.admin-tab-btn').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            
            // Add active class to clicked tab button
            event.target.classList.remove('border-transparent', 'text-gray-500');
            event.target.classList.add('border-blue-500', 'text-blue-600');
        }

        function loadAdminData() {
            updateStats();
            loadApplicationsTable();
            loadUsersTable();
            loadServicesGrid();
        }

        function updateStats() {
            const total = applications.length;
            const pending = applications.filter(app => app.status === 'आवेदन प्राप्त').length;
            const processing = applications.filter(app => app.status === 'प्रोसेसिंग में').length;
            const completed = applications.filter(app => app.status === 'पूर्ण').length;
            
            document.getElementById('totalApplications').textContent = total;
            document.getElementById('pendingApplications').textContent = pending;
            document.getElementById('processingApplications').textContent = processing;
            document.getElementById('completedApplications').textContent = completed;
        }

        function loadApplicationsTable() {
            const tbody = document.getElementById('applicationsTableBody');
            tbody.innerHTML = '';
            
            applications.forEach(app => {
                const row = `
                    <tr>
                        <td class="font-mono text-sm">${app.trackingId}</td>
                        <td>${app.fullName}</td>
                        <td>${app.serviceType}</td>
                        <td>${app.mobile}</td>
                        <td>${formatDate(app.timestamp)}</td>
                        <td>
                            <select onchange="updateStatus('${app.trackingId}', this.value)" class="status-badge status-${app.status === 'आवेदन प्राप्त' ? 'pending' : app.status === 'प्रोसेसिंग में' ? 'processing' : 'completed'}">
                                <option value="आवेदन प्राप्त" ${app.status === 'आवेदन प्राप्त' ? 'selected' : ''}>Pending</option>
                                <option value="प्रोसेसिंग में" ${app.status === 'प्रोसेसिंग में' ? 'selected' : ''}>Processing</option>
                                <option value="पूर्ण" ${app.status === 'पूर्ण' ? 'selected' : ''}>Completed</option>
                            </select>
                        </td>
                        <td>
                            <button onclick="viewApplication('${app.trackingId}')" class="text-blue-600 hover:text-blue-800 mr-2">View</button>
                            <button onclick="deleteApplication('${app.trackingId}')" class="text-red-600 hover:text-red-800">Delete</button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function updateStatus(trackingId, newStatus) {
            const appIndex = applications.findIndex(app => app.trackingId === trackingId);
            if (appIndex !== -1) {
                applications[appIndex].status = newStatus;
                localStorage.setItem('applications', JSON.stringify(applications));
                updateStats();
                showNotification('स्थिति अपडेट हो गई');
            }
        }

        function deleteApplication(trackingId) {
            if (confirm('क्या आप इस आवेदन को हटाना चाहते हैं?')) {
                applications = applications.filter(app => app.trackingId !== trackingId);
                localStorage.setItem('applications', JSON.stringify(applications));
                loadAdminData();
                showNotification('आवेदन हटा दिया गया');
            }
        }

        function filterApplications() {
            const filter = document.getElementById('statusFilter').value;
            const rows = document.querySelectorAll('#applicationsTableBody tr');
            
            rows.forEach(row => {
                if (!filter || row.innerHTML.includes(filter)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        function loadUsersTable() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            users.forEach(user => {
                const userApps = applications.filter(app => app.mobile === user.mobile);
                const totalApps = userApps.length;
                
                const row = `
                    <tr>
                        <td class="font-mono text-sm">${user.id}</td>
                        <td>${user.name}</td>
                        <td>${user.mobile}</td>
                        <td>${formatDate(user.registeredDate)}</td>
                        <td>${formatDate(user.lastLogin)}</td>
                        <td class="text-center">
                            <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-sm font-medium">
                                ${totalApps}
                            </span>
                        </td>
                        <td>
                            <button onclick="viewUserDetails('${user.id}')" class="text-blue-600 hover:text-blue-800 mr-2">View</button>
                            <button onclick="deleteUser('${user.id}')" class="text-red-600 hover:text-red-800">Delete</button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function viewUserDetails(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            const userApps = applications.filter(app => app.mobile === user.mobile);
            
            const modalContent = `
                <div class="modal show" style="display: flex; align-items: center; justify-content: center;">
                    <div class="modal-content" style="max-width: 600px;">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-gray-800">User Details</h3>
                            <button onclick="this.closest('.modal').remove()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                        </div>
                        
                        <div class="space-y-4 mb-6">
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="font-semibold text-gray-700">User ID:</label>
                                    <p class="font-mono text-sm bg-gray-100 p-2 rounded">${user.id}</p>
                                </div>
                                <div>
                                    <label class="font-semibold text-gray-700">Name:</label>
                                    <p>${user.name}</p>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="font-semibold text-gray-700">Mobile:</label>
                                    <p>${user.mobile}</p>
                                </div>
                                <div>
                                    <label class="font-semibold text-gray-700">Total Applications:</label>
                                    <p class="font-bold text-blue-600">${userApps.length}</p>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="font-semibold text-gray-700">Registered:</label>
                                    <p>${formatDate(user.registeredDate)}</p>
                                </div>
                                <div>
                                    <label class="font-semibold text-gray-700">Last Login:</label>
                                    <p>${formatDate(user.lastLogin)}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="border-t pt-4">
                            <h4 class="font-semibold text-gray-700 mb-3">Recent Applications:</h4>
                            ${userApps.length > 0 ? `
                                <div class="space-y-2 max-h-40 overflow-y-auto">
                                    ${userApps.slice(0, 5).map(app => `
                                        <div class="flex justify-between items-center p-2 bg-gray-50 rounded">
                                            <div>
                                                <span class="font-mono text-xs text-gray-600">${app.trackingId}</span>
                                                <p class="text-sm">${app.serviceType}</p>
                                            </div>
                                            <div class="text-right">
                                                <span class="status-badge status-${app.status === 'आवेदन प्राप्त' ? 'pending' : app.status === 'प्रोसेसिंग में' ? 'processing' : 'completed'}">${app.status}</span>
                                                <p class="text-xs text-gray-500">${formatDate(app.timestamp)}</p>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            ` : '<p class="text-gray-500 text-sm">No applications yet</p>'}
                        </div>
                        
                        <div class="mt-6 flex justify-end">
                            <button onclick="this.closest('.modal').remove()" class="btn btn-secondary">Close</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalContent);
        }

        function deleteUser(userId) {
            if (confirm('Are you sure you want to delete this user? This will also delete all their applications.')) {
                const user = users.find(u => u.id === userId);
                if (user) {
                    // Remove user
                    users = users.filter(u => u.id !== userId);
                    localStorage.setItem('users', JSON.stringify(users));
                    
                    // Remove user's applications
                    applications = applications.filter(app => app.mobile !== user.mobile);
                    localStorage.setItem('applications', JSON.stringify(applications));
                    
                    loadAdminData();
                    showNotification('User and their applications deleted successfully');
                }
            }
        }

        function exportUsers() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "User ID,Name,Mobile,Registered Date,Last Login,Total Applications\n"
                + users.map(user => {
                    const userApps = applications.filter(app => app.mobile === user.mobile);
                    return `${user.id},${user.name},${user.mobile},${formatDate(user.registeredDate)},${formatDate(user.lastLogin)},${userApps.length}`;
                }).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "mushtaq_store_users.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function exportData() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "Tracking ID,Name,Service,Mobile,Email,Address,Date,Status\n"
                + applications.map(app => 
                    `${app.trackingId},${app.fullName},${app.serviceType},${app.mobile},${app.email || ''},${app.address},${formatDate(app.timestamp)},${app.status}`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "mushtaq_store_applications.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function saveSettings() {
            showNotification('सेटिंग्स सेव हो गईं');
        }

        function saveGoogleSheetsConfig() {
            const scriptUrl = document.getElementById('googleScriptUrl').value.trim();
            const sheetId = document.getElementById('googleSheetId').value.trim();
            
            if (!scriptUrl) {
                showNotification('कृपया Apps Script URL डालें', 'error');
                return;
            }
            
            if (!sheetId) {
                showNotification('कृपया Google Sheet ID डालें', 'error');
                return;
            }
            
            // Validate Apps Script URL format
            if (!scriptUrl.includes('script.google.com/macros/s/') || !scriptUrl.includes('/exec')) {
                showNotification('गलत Apps Script URL format. कृपया सही URL डालें।', 'error');
                return;
            }
            
            // Update global config
            GOOGLE_SHEETS_CONFIG.scriptUrl = scriptUrl;
            GOOGLE_SHEETS_CONFIG.sheetId = sheetId;
            
            // Save to localStorage
            localStorage.setItem('googleSheetsConfig', JSON.stringify(GOOGLE_SHEETS_CONFIG));
            
            showNotification('✅ Google Sheets configuration saved successfully!');
        }

        async function testGoogleSheets() {
            const scriptUrl = document.getElementById('googleScriptUrl').value.trim();
            const sheetId = document.getElementById('googleSheetId').value.trim();
            
            if (!scriptUrl) {
                showNotification('कृपया पहले Apps Script URL डालें', 'error');
                return;
            }
            
            if (!sheetId) {
                showNotification('कृपया Google Sheet ID डालें', 'error');
                return;
            }
            
            // Validate URL format
            if (!scriptUrl.includes('script.google.com/macros/s/') || !scriptUrl.includes('/exec')) {
                showNotification('गलत Apps Script URL format!', 'error');
                return;
            }
            
            try {
                showNotification('🔄 Testing connection... कृपया प्रतीक्षा करें', 'info');
                
                // Create comprehensive test data
                const testData = {
                    timestamp: new Date().toLocaleString('hi-IN'),
                    trackingId: 'TEST-' + Date.now(),
                    serviceType: 'Connection Test',
                    fullName: 'Test User - Mushtaq Store',
                    mobile: '9999999999',
                    email: 'test@mushtaqstore.com',
                    address: 'Test Address for Connection',
                    status: 'Test Entry',
                    fatherName: 'Test Father',
                    dob: '1990-01-01',
                    aadhaarNumber: 'TEST123456789',
                    panNumber: '',
                    constituency: '',
                    familyMembers: '',
                    rationCard: '',
                    occupation: 'Testing',
                    annualIncome: '50000',
                    bankAccount: '',
                    ifsc: ''
                };
                
                // Send test data to Google Sheets
                const response = await fetch(scriptUrl, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                });
                
                // Wait a moment for processing
                setTimeout(() => {
                    showNotification('✅ Test successful! Check your Google Sheet - एक test row add हो गया होगा!', 'success');
                }, 2000);
                
            } catch (error) {
                console.error('Test error:', error);
                showNotification('❌ Test failed! Apps Script URL या Sheet ID check करें', 'error');
            }
        }

        // Service Management Functions
        function showAddServiceModal() {
            currentEditingService = null;
            document.getElementById('serviceModalTitle').textContent = 'Add New Service';
            document.getElementById('serviceManagementForm').reset();
            document.getElementById('serviceManagementModal').classList.add('show');
        }

        function editService(serviceId) {
            const service = customServices.find(s => s.id === serviceId);
            if (!service) return;
            
            currentEditingService = service;
            document.getElementById('serviceModalTitle').textContent = 'Edit Service';
            
            // Fill form with service data
            document.getElementById('serviceName').value = service.name;
            document.getElementById('serviceIconSelect').value = service.icon;
            document.getElementById('serviceDescription').value = service.description || '';
            document.getElementById('serviceOptions').value = service.options ? service.options.join('\n') : '';
            document.getElementById('servicePrice').value = service.price || '';
            document.getElementById('serviceStatus').value = service.status || 'active';
            
            document.getElementById('serviceManagementModal').classList.add('show');
        }

        function closeServiceModal() {
            document.getElementById('serviceManagementModal').classList.remove('show');
            currentEditingService = null;
        }

        function saveService(event) {
            event.preventDefault();
            
            const formData = {
                id: currentEditingService ? currentEditingService.id : Date.now().toString(),
                name: document.getElementById('serviceName').value.trim(),
                icon: document.getElementById('serviceIconSelect').value,
                description: document.getElementById('serviceDescription').value.trim(),
                options: document.getElementById('serviceOptions').value.trim().split('\n').filter(opt => opt.trim()),
                price: document.getElementById('servicePrice').value.trim(),
                status: document.getElementById('serviceStatus').value,
                createdAt: currentEditingService ? currentEditingService.createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            if (currentEditingService) {
                // Update existing service
                const index = customServices.findIndex(s => s.id === currentEditingService.id);
                if (index !== -1) {
                    customServices[index] = formData;
                }
            } else {
                // Add new service
                customServices.push(formData);
            }
            
            localStorage.setItem('customServices', JSON.stringify(customServices));
            loadServicesGrid();
            loadHomepageServices(); // Refresh homepage services
            closeServiceModal();
            
            showNotification(currentEditingService ? 'Service updated successfully!' : 'New service added successfully!');
        }

        function deleteService(serviceId) {
            if (confirm('Are you sure you want to delete this service?')) {
                customServices = customServices.filter(s => s.id !== serviceId);
                localStorage.setItem('customServices', JSON.stringify(customServices));
                loadServicesGrid();
                loadHomepageServices(); // Refresh homepage services
                showNotification('Service deleted successfully!');
            }
        }

        function toggleServiceStatus(serviceId) {
            const service = customServices.find(s => s.id === serviceId);
            if (service) {
                service.status = service.status === 'active' ? 'inactive' : 'active';
                localStorage.setItem('customServices', JSON.stringify(customServices));
                loadServicesGrid();
                loadHomepageServices(); // Refresh homepage services
                showNotification(`Service ${service.status === 'active' ? 'activated' : 'deactivated'}!`);
            }
        }

        function loadServicesGrid() {
            const grid = document.getElementById('servicesGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            // Show default services first
            const defaultServices = [
                { id: 'aadhaar', name: 'आधार कार्ड सेवाएं', icon: '🆔', price: '₹50-200', status: 'active', isDefault: true },
                { id: 'pan', name: 'पैन कार्ड सेवाएं', icon: '💳', price: '₹100-300', status: 'active', isDefault: true },
                { id: 'voter', name: 'वोटर आईडी सेवाएं', icon: '🗳️', price: '₹80-250', status: 'active', isDefault: true },
                { id: 'ration', name: 'राशन कार्ड सेवाएं', icon: '🍚', price: '₹100-400', status: 'active', isDefault: true },
                { id: 'income', name: 'प्रमाण पत्र सेवाएं', icon: '📄', price: '₹150-500', status: 'active', isDefault: true },
                { id: 'other', name: 'अन्य सेवाएं', icon: '⚙️', price: '₹50-1000', status: 'active', isDefault: true }
            ];
            
            [...defaultServices, ...customServices].forEach(service => {
                const serviceCard = `
                    <div class="bg-white rounded-lg shadow-lg p-6 border ${service.status === 'inactive' ? 'opacity-50' : ''}">
                        <div class="flex justify-between items-start mb-4">
                            <div class="text-3xl">${service.icon}</div>
                            <div class="flex space-x-2">
                                ${service.status === 'active' ? 
                                    '<span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium">Active</span>' : 
                                    '<span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium">Inactive</span>'
                                }
                            </div>
                        </div>
                        
                        <h4 class="font-bold text-lg mb-2">${service.name}</h4>
                        ${service.description ? `<p class="text-gray-600 text-sm mb-3">${service.description}</p>` : ''}
                        ${service.price ? `<p class="text-green-600 font-bold mb-4">${service.price}</p>` : ''}
                        
                        <div class="flex space-x-2">
                            ${!service.isDefault ? `
                                <button onclick="editService('${service.id}')" class="btn btn-secondary text-xs px-3 py-1">
                                    ✏️ Edit
                                </button>
                                <button onclick="deleteService('${service.id}')" class="btn text-xs px-3 py-1 bg-red-100 text-red-600 hover:bg-red-200">
                                    🗑️ Delete
                                </button>
                                <button onclick="toggleServiceStatus('${service.id}')" class="btn text-xs px-3 py-1 ${service.status === 'active' ? 'bg-yellow-100 text-yellow-600 hover:bg-yellow-200' : 'bg-green-100 text-green-600 hover:bg-green-200'}">
                                    ${service.status === 'active' ? '⏸️ Disable' : '▶️ Enable'}
                                </button>
                            ` : `
                                <span class="text-xs text-gray-500 italic">Default Service</span>
                            `}
                        </div>
                    </div>
                `;
                grid.innerHTML += serviceCard;
            });
        }

        // Hero Section Management Functions
        function updateHeroPreview() {
            const title = document.getElementById('heroTitle').value || 'सभी सरकारी सेवाएं एक जगह';
            const subtitle = document.getElementById('heroSubtitle').value || 'आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें';
            const icon = document.getElementById('heroIcon').value || '💼';
            
            document.getElementById('previewTitle').textContent = title;
            document.getElementById('previewSubtitle').textContent = subtitle;
            document.getElementById('previewIcon').textContent = icon;
        }

        function saveHeroSettings() {
            const settings = {
                title: document.getElementById('heroTitle').value || 'सभी सरकारी सेवाएं एक जगह',
                subtitle: document.getElementById('heroSubtitle').value || 'आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें',
                icon: document.getElementById('heroIcon').value || '💼',
                backgroundImage: heroSettings.backgroundImage || null
            };
            
            heroSettings = settings;
            localStorage.setItem('heroSettings', JSON.stringify(heroSettings));
            updateHeroSection();
            showNotification('✅ Hero section updated successfully!');
        }

        function resetHeroSettings() {
            if (confirm('Are you sure you want to reset to default settings?')) {
                heroSettings = {};
                localStorage.removeItem('heroSettings');
                
                // Reset form fields
                document.getElementById('heroTitle').value = 'सभी सरकारी सेवाएं एक जगह';
                document.getElementById('heroSubtitle').value = 'आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें';
                document.getElementById('heroIcon').value = '💼';
                document.getElementById('heroBackground').value = '';
                
                updateHeroPreview();
                updateHeroSection();
                showNotification('Hero section reset to default!');
            }
        }

        function updateHeroSection() {
            const heroSection = document.querySelector('main section');
            if (!heroSection) return;
            
            const title = heroSettings.title || 'सभी सरकारी सेवाएं एक जगह';
            const subtitle = heroSettings.subtitle || 'आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें';
            const icon = heroSettings.icon || '💼';
            
            // Update hero content
            const heroTitle = heroSection.querySelector('h2');
            const heroSubtitle = heroSection.querySelector('p');
            const heroIcon = heroSection.querySelector('.floating-animation .w-24');
            
            if (heroTitle) heroTitle.textContent = title;
            if (heroSubtitle) heroSubtitle.textContent = subtitle;
            if (heroIcon) heroIcon.textContent = icon;
            
            // Apply background image if set
            if (heroSettings.backgroundImage) {
                heroSection.style.backgroundImage = `url(${heroSettings.backgroundImage})`;
                heroSection.style.backgroundSize = 'cover';
                heroSection.style.backgroundPosition = 'center';
                heroSection.style.backgroundRepeat = 'no-repeat';
            } else {
                heroSection.style.backgroundImage = '';
            }
        }

        function handleHeroImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showNotification('Image size should be less than 5MB', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                heroSettings.backgroundImage = e.target.result;
                updateHeroPreview();
                showNotification('Background image uploaded! Click Save Changes to apply.');
            };
            reader.readAsDataURL(file);
        }

        // File Upload Functions
        function handleServiceDocuments(event) {
            const files = Array.from(event.target.files);
            const uploadedFilesContainer = document.getElementById('serviceUploadedFiles');
            
            files.forEach(file => {
                if (file.size > 5 * 1024 * 1024) {
                    showNotification(`File ${file.name} is too large. Max 5MB allowed.`, 'error');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const fileData = {
                        name: file.name,
                        type: file.type,
                        size: file.size,
                        data: e.target.result,
                        uploadedAt: new Date().toISOString()
                    };
                    
                    uploadedDocuments.push(fileData);
                    
                    // Create file preview
                    const filePreview = document.createElement('div');
                    filePreview.className = 'flex items-center justify-between bg-gray-100 p-3 rounded-lg';
                    filePreview.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <div class="text-2xl">
                                ${file.type.includes('pdf') ? '📄' : '🖼️'}
                            </div>
                            <div>
                                <p class="font-medium text-sm">${file.name}</p>
                                <p class="text-xs text-gray-500">${(file.size / 1024).toFixed(1)} KB</p>
                            </div>
                        </div>
                        <button onclick="removeUploadedFile('${file.name}')" class="text-red-500 hover:text-red-700">
                            ❌
                        </button>
                    `;
                    
                    uploadedFilesContainer.appendChild(filePreview);
                };
                reader.readAsDataURL(file);
            });
            
            // Clear the input
            event.target.value = '';
        }

        function removeUploadedFile(fileName) {
            uploadedDocuments = uploadedDocuments.filter(file => file.name !== fileName);
            
            // Remove from UI
            const container = document.getElementById('serviceUploadedFiles');
            const fileElements = container.querySelectorAll('div');
            fileElements.forEach(element => {
                if (element.textContent.includes(fileName)) {
                    element.remove();
                }
            });
        }

        function handleServiceImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (file.size > 5 * 1024 * 1024) {
                showNotification('Image size should be less than 5MB', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                showNotification('Service image uploaded successfully!');
                // Store image data for the service
                // This would be saved when the service is saved
            };
            reader.readAsDataURL(file);
        }

        // Load homepage services
        function loadHomepageServices() {
            const homepageGrid = document.getElementById('servicesGridHomepage');
            if (!homepageGrid) return;
            
            homepageGrid.innerHTML = '';
            
            // Default services
            const defaultServices = [
                { 
                    id: 'aadhaar', 
                    name: 'आधार कार्ड सेवाएं', 
                    icon: '🆔', 
                    price: '₹50-200', 
                    status: 'active',
                    options: ['नया आधार कार्ड', 'आधार अपडेट', 'मोबाइल नंबर लिंक', 'आधार डाउनलोड']
                },
                { 
                    id: 'pan', 
                    name: 'पैन कार्ड सेवाएं', 
                    icon: '💳', 
                    price: '₹100-300', 
                    status: 'active',
                    options: ['नया पैन कार्ड', 'पैन कार्ड सुधार', 'डुप्लिकेट पैन कार्ड', 'पैन स्टेटस चेक']
                },
                { 
                    id: 'voter', 
                    name: 'वोटर आईडी सेवाएं', 
                    icon: '🗳️', 
                    price: '₹80-250', 
                    status: 'active',
                    options: ['नई वोटर आईडी', 'वोटर आईडी सुधार', 'पता बदलाव', 'डुप्लिकेट वोटर आईडी']
                },
                { 
                    id: 'ration', 
                    name: 'राशन कार्ड सेवाएं', 
                    icon: '🍚', 
                    price: '₹100-400', 
                    status: 'active',
                    options: ['नया राशन कार्ड', 'राशन कार्ड सुधार', 'सदस्य जोड़ना/हटाना', 'राशन कार्ड ट्रांसफर']
                },
                { 
                    id: 'income', 
                    name: 'आय प्रमाण पत्र', 
                    icon: '📄', 
                    price: '₹150-500', 
                    status: 'active',
                    options: ['आय प्रमाण पत्र', 'जाति प्रमाण पत्र', 'निवास प्रमाण पत्र', 'चरित्र प्रमाण पत्र']
                },
                { 
                    id: 'other', 
                    name: 'अन्य सेवाएं', 
                    icon: '⚙️', 
                    price: '₹50-1000', 
                    status: 'active',
                    options: ['बैंक खाता खोलना', 'बिजली कनेक्शन', 'गैस कनेक्शन', 'मोबाइल रिचार्ज']
                }
            ];
            
            // Combine default and custom services, only show active ones
            const allServices = [...defaultServices, ...customServices.filter(s => s.status === 'active')];
            
            allServices.forEach(service => {
                if (service.status !== 'active') return;
                
                const serviceCard = `
                    <div class="service-card card-hover" onclick="checkLoginAndOpenService('${service.id}')">
                        <div class="service-icon">
                            ${service.icon}
                        </div>
                        <h3 class="text-lg font-bold text-center mb-2">${service.name}</h3>
                        <ul class="text-gray-600 space-y-2">
                            ${service.options ? service.options.slice(0, 4).map(option => `<li>• ${option}</li>`).join('') : ''}
                        </ul>
                        <div class="text-center mt-4">
                            ${service.price ? `<span class="text-2xl font-bold text-green-600">${service.price}</span>` : ''}
                            <div class="mt-2 text-xs text-orange-600 font-medium">
                                🔒 Login Required
                            </div>
                        </div>
                    </div>
                `;
                homepageGrid.innerHTML += serviceCard;
            });
        }

        // Website customization functions
        let websiteSettings = JSON.parse(localStorage.getItem('websiteSettings') || '{}');

        function saveWebsiteSettings() {
            const settings = {
                heroTitle: document.getElementById('heroTitle').value || 'सभी सरकारी सेवाएं एक जगह',
                heroSubtitle: document.getElementById('heroSubtitle').value || 'आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें',
                heroIcon: document.getElementById('heroIcon').value || '💼',
                storeName: document.getElementById('storeName').value || 'Mushtaq Store',
                storeTagline: document.getElementById('storeTagline').value || 'Digital Services & Solutions',
                storeIcon: document.getElementById('storeIcon').value || '🏪',
                contactPhone: document.getElementById('contactPhone').value || '+91 93550 22066',
                contactAddress: document.getElementById('contactAddress').value || 'Mushtaq Store, Main Market',
                backgroundImage: websiteSettings.backgroundImage || null
            };
            
            websiteSettings = settings;
            localStorage.setItem('websiteSettings', JSON.stringify(websiteSettings));
            
            // Apply changes to current website
            applyWebsiteSettings();
            
            // Update preview
            refreshPreview();
            
            showNotification('✅ Website settings saved successfully!');
        }

        function resetWebsiteSettings() {
            if (confirm('Are you sure you want to reset all website settings to default?')) {
                websiteSettings = {};
                localStorage.removeItem('websiteSettings');
                
                // Reset form fields
                document.getElementById('heroTitle').value = 'सभी सरकारी सेवाएं एक जगह';
                document.getElementById('heroSubtitle').value = 'आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें';
                document.getElementById('heroIcon').value = '💼';
                document.getElementById('storeName').value = 'Mushtaq Store';
                document.getElementById('storeTagline').value = 'Digital Services & Solutions';
                document.getElementById('storeIcon').value = '🏪';
                document.getElementById('contactPhone').value = '+91 93550 22066';
                document.getElementById('contactAddress').value = 'Mushtaq Store, Main Market';
                document.getElementById('heroBackground').value = '';
                
                applyWebsiteSettings();
                refreshPreview();
                showNotification('Website reset to default settings!');
            }
        }

        function applyWebsiteSettings() {
            // Update hero section
            const heroTitle = document.querySelector('main section h2');
            const heroSubtitle = document.querySelector('main section p');
            const heroIcon = document.querySelector('.floating-animation .w-24');
            
            if (heroTitle) heroTitle.textContent = websiteSettings.heroTitle || 'सभी सरकारी सेवाएं एक जगह';
            if (heroSubtitle) heroSubtitle.textContent = websiteSettings.heroSubtitle || 'आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें';
            if (heroIcon) heroIcon.textContent = websiteSettings.heroIcon || '💼';
            
            // Update header
            const storeName = document.querySelector('header h1');
            const storeTagline = document.querySelector('header p');
            const storeIcon = document.querySelector('header .w-12 span');
            
            if (storeName) storeName.textContent = websiteSettings.storeName || 'Mushtaq Store';
            if (storeTagline) storeTagline.textContent = websiteSettings.storeTagline || 'Digital Services & Solutions';
            if (storeIcon) storeIcon.textContent = websiteSettings.storeIcon || '🏪';
            
            // Update contact section
            const contactPhone = document.querySelector('section:last-child .grid div:first-child p');
            const contactAddress = document.querySelector('section:last-child .grid div:last-child p');
            
            if (contactPhone) contactPhone.textContent = websiteSettings.contactPhone || '+91 93550 22066';
            if (contactAddress) contactAddress.textContent = websiteSettings.contactAddress || 'Mushtaq Store, Main Market';
        }

        function refreshPreview() {
            const iframe = document.getElementById('websitePreview');
            if (!iframe) return;
            
            try {
                // Get current settings safely
                const settings = {
                    heroTitle: document.getElementById('heroTitle')?.value || 'सभी सरकारी सेवाएं एक जगह',
                    heroSubtitle: document.getElementById('heroSubtitle')?.value || 'आधार कार्ड से लेकर पैन कार्ड तक, सभी डिजिटल सेवाएं घर बैठे प्राप्त करें',
                    heroIcon: document.getElementById('heroIcon')?.value || '💼',
                    storeName: document.getElementById('storeName')?.value || 'Mushtaq Store',
                    storeTagline: document.getElementById('storeTagline')?.value || 'Digital Services & Solutions',
                    storeIcon: document.getElementById('storeIcon')?.value || '🏪',
                    contactPhone: document.getElementById('contactPhone')?.value || '+91 93550 22066',
                    contactAddress: document.getElementById('contactAddress')?.value || 'Mushtaq Store, Main Market'
                };
                
                // Create simple preview content
                const previewContent = `
                    <div style="font-family: Arial, sans-serif; padding: 20px; background: #f3f4f6;">
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="font-size: 24px;">${settings.storeIcon}</div>
                                <div>
                                    <h1 style="margin: 0; font-size: 24px;">${settings.storeName}</h1>
                                    <p style="margin: 5px 0 0 0; opacity: 0.9;">${settings.storeTagline}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin: 40px 0;">
                            <div style="font-size: 48px; margin-bottom: 20px;">${settings.heroIcon}</div>
                            <h2 style="font-size: 28px; margin-bottom: 15px; color: #1f2937;">${settings.heroTitle}</h2>
                            <p style="font-size: 16px; color: #6b7280; max-width: 600px; margin: 0 auto;">${settings.heroSubtitle}</p>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 40px 0;">
                            <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 32px; margin-bottom: 10px;">🆔</div>
                                <h3 style="margin: 0 0 10px 0;">आधार कार्ड सेवाएं</h3>
                                <p style="color: #16a34a; font-weight: bold;">₹50-200</p>
                            </div>
                            <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 32px; margin-bottom: 10px;">💳</div>
                                <h3 style="margin: 0 0 10px 0;">पैन कार्ड सेवाएं</h3>
                                <p style="color: #16a34a; font-weight: bold;">₹100-300</p>
                            </div>
                            <div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); text-align: center;">
                                <div style="font-size: 32px; margin-bottom: 10px;">🗳️</div>
                                <h3 style="margin: 0 0 10px 0;">वोटर आईडी सेवाएं</h3>
                                <p style="color: #16a34a; font-weight: bold;">₹80-250</p>
                            </div>
                        </div>
                        
                        <div style="background: linear-gradient(135deg, #2563eb, #7c3aed); color: white; padding: 30px; border-radius: 12px; text-align: center;">
                            <h3 style="margin: 0 0 20px 0; font-size: 24px;">संपर्क करें</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div>
                                    <h4 style="margin: 0 0 5px 0;">📞 फोन</h4>
                                    <p style="margin: 0;">${settings.contactPhone}</p>
                                </div>
                                <div>
                                    <h4 style="margin: 0 0 5px 0;">📍 पता</h4>
                                    <p style="margin: 0;">${settings.contactAddress}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                iframe.srcdoc = previewContent;
                
            } catch (error) {
                console.error('Preview error:', error);
                // Fallback preview
                iframe.srcdoc = '<div style="padding: 20px; text-align: center; font-family: Arial;">Preview Loading...</div>';
            }
        }

        // Simplified preview function - no complex HTML generation

        function previewWebsite() {
            // Open current website in a new tab for full preview
            const currentHTML = document.documentElement.outerHTML;
            const blob = new Blob([currentHTML], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            window.open(url, '_blank');
            
            // Clean up the URL after a delay
            setTimeout(() => URL.revokeObjectURL(url), 10000);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-login user if they were previously logged in
            if (currentUser) {
                isUserLoggedIn = true;
                // Update header to show user is logged in
                updateHeaderForLoggedInUser();
            }
            
            // Load saved Google Sheets config
            const savedConfig = localStorage.getItem('googleSheetsConfig');
            if (savedConfig) {
                const config = JSON.parse(savedConfig);
                GOOGLE_SHEETS_CONFIG.scriptUrl = config.scriptUrl;
                GOOGLE_SHEETS_CONFIG.sheetId = config.sheetId;
                
                document.getElementById('googleScriptUrl').value = config.scriptUrl;
                document.getElementById('googleSheetId').value = config.sheetId;
            }
            
            // Load homepage services
            loadHomepageServices();
            
            // Apply saved website settings
            applyWebsiteSettings();
            
            // Load services grid when admin panel is opened
            setTimeout(() => {
                loadServicesGrid();
            }, 500);
            
            // Initialize preview functionality safely
            setTimeout(() => {
                try {
                    const heroTitle = document.getElementById('heroTitle');
                    const heroSubtitle = document.getElementById('heroSubtitle');
                    const heroIcon = document.getElementById('heroIcon');
                    const storeName = document.getElementById('storeName');
                    const storeTagline = document.getElementById('storeTagline');
                    const storeIcon = document.getElementById('storeIcon');
                    const contactPhone = document.getElementById('contactPhone');
                    const contactAddress = document.getElementById('contactAddress');
                    
                    if (heroTitle) heroTitle.addEventListener('input', refreshPreview);
                    if (heroSubtitle) heroSubtitle.addEventListener('input', refreshPreview);
                    if (heroIcon) heroIcon.addEventListener('change', refreshPreview);
                    if (storeName) storeName.addEventListener('input', refreshPreview);
                    if (storeTagline) storeTagline.addEventListener('input', refreshPreview);
                    if (storeIcon) storeIcon.addEventListener('change', refreshPreview);
                    if (contactPhone) contactPhone.addEventListener('input', refreshPreview);
                    if (contactAddress) contactAddress.addEventListener('input', refreshPreview);
                } catch (error) {
                    console.log('Preview initialization skipped - admin panel not loaded yet');
                }
            }, 2000);
            
            // Add smooth scrolling
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });
            
            // Add entrance animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('slide-in');
                    }
                });
            });
            
            document.querySelectorAll('.service-card').forEach(card => {
                observer.observe(card);
            });
        });

        // Close modals when clicking outside
        document.addEventListener('click', function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.classList.remove('show');
                }
            });
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                document.querySelectorAll('.modal.show').forEach(modal => {
                    modal.classList.remove('show');
                });
            }
        }); 
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9832d951d1db5522',t:'MTc1ODU1NTA4Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

